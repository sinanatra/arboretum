import{s as J,n as H,d,i as v,p as P,r as ie,C as w,h as k,D as C,z as Xe,x as o,S as he,e as b,y as _e,E as ae,f as U,l as X,j as F,t as W,T as tt,b as Q,U as de,B as lt,k as $,m as ee}from"../chunks/CG7iAfK8.js";import{S as K,i as Z,d as te,t as B,a as j,m as le,e as re,b as ne,c as Qe,g as Je}from"../chunks/iLweqiqo.js";import{b as rt,e as R,u as oe,d as ce,p as nt,a as ge,z as at,s as me,i as ke,m as pe,c as ye,l as be}from"../chunks/BOaA3tQ3.js";function ve(i,e,t){const l=i.slice();return l[10]=e[t],l}function we(i){let e,t=[],l=new Map,n=R(i[2]);const s=r=>r[10].x+"-"+r[10].y;for(let r=0;r<n.length;r+=1){let a=ve(i,n,r),c=s(a);l.set(c,t[r]=Ce(c,a))}return{c(){e=C("g");for(let r=0;r<t.length;r+=1)t[r].c()},l(r){e=w(r,"g",{});var a=k(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(d)},m(r,a){v(r,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i[7](e)},p(r,a){a&5&&(n=R(r[2]),t=oe(t,a,s,1,r,n,l,e,ce,Ce,null,ve))},d(r){r&&d(e);for(let a=0;a<t.length;a+=1)t[a].d();i[7](null)}}}function Ce(i,e){let t,l,n,s;return{key:i,first:null,c(){t=C("rect"),this.h()},l(r){t=w(r,"rect",{x:!0,y:!0,width:!0,height:!0,class:!0}),k(t).forEach(d),this.h()},h(){o(t,"x",l=e[10].x),o(t,"y",n=e[10].y),o(t,"width",e[0]),o(t,"height",e[0]),o(t,"class",s=he("pixel "+e[10].type)+" svelte-rhs3f3"),this.first=t},m(r,a){v(r,t,a)},p(r,a){e=r,a&4&&l!==(l=e[10].x)&&o(t,"x",l),a&4&&n!==(n=e[10].y)&&o(t,"y",n),a&1&&o(t,"width",e[0]),a&1&&o(t,"height",e[0]),a&4&&s!==(s=he("pixel "+e[10].type)+" svelte-rhs3f3")&&o(t,"class",s)},d(r){r&&d(t)}}}function st(i){let e,t=i[2].length>0&&we(i);return{c(){t&&t.c(),e=P()},l(l){t&&t.l(l),e=P()},m(l,n){t&&t.m(l,n),v(l,e,n)},p(l,[n]){l[2].length>0?t?t.p(l,n):(t=we(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:H,o:H,d(l){l&&d(e),t&&t.d(l)}}}const it=10;function ot(i,e,t){let{xScale:l}=e,{yScale:n}=e,{width:s=window.innerWidth}=e,{height:r=window.innerHeight}=e,{gridSize:a=2}=e,c=null,f,u=[];ie(async()=>{try{c=await(await fetch("/pixelated.geojson")).json(),l&&n&&g()}catch(h){console.error("Error loading map.geojson",h)}});function g(){t(2,u=[]);const h=Math.ceil(s/a),m=Math.ceil(r/a),x=c.features.filter(E=>E.geometry.type==="Polygon"||E.geometry.type==="MultiPolygon"),z=c.features.filter(E=>{var A;return(E.geometry.type==="LineString"||E.geometry.type==="MultiLineString")&&((A=E.properties)==null?void 0:A.highway)}).map((E,A)=>{try{const p=rt(E,it,{units:"meters"});return p.id=E.id||A,p}catch(p){return console.error("Buffer error",p),null}}).filter(E=>E);let y=0;function D(E){var p,M,S;const A=performance.now();for(;y<m&&((E==null?void 0:E.timeRemaining())>0||performance.now()-A<8);){for(let N=0;N<h;N++){const Y=N*a,I=y*a,q=l.invert(Y+a/2),T=n.invert(I+a/2),L=nt([q,T]);let G=null;for(let V of z)if(ge(L,V)){G="street";break}if(!G){for(let V of x)if(ge(L,V)){((p=V.properties)==null?void 0:p.leisure)==="park"?G="park":((M=V.properties)==null?void 0:M.natural)==="water"||(S=V.properties)!=null&&S.waterway?G="water":G="other";break}}G&&t(2,u=[...u,{x:Y,y:I,type:G}])}y++}y<m&&(window.requestIdleCallback?requestIdleCallback(D):requestAnimationFrame(()=>D()))}window.requestIdleCallback?requestIdleCallback(D):requestAnimationFrame(()=>D())}function _(h){Xe[h?"unshift":"push"](()=>{f=h,t(1,f)})}return i.$$set=h=>{"xScale"in h&&t(3,l=h.xScale),"yScale"in h&&t(4,n=h.yScale),"width"in h&&t(5,s=h.width),"height"in h&&t(6,r=h.height),"gridSize"in h&&t(0,a=h.gridSize)},[a,f,u,l,n,s,r,_]}class ct extends K{constructor(e){super(),Z(this,e,ot,st,J,{xScale:3,yScale:4,width:5,height:6,gridSize:0})}}function De(i,e,t){const l=i.slice();return l[19]=e[t],l[21]=t,l}function Ee(i,e,t){const l=i.slice();return l[19]=e[t],l}function Se(i,e,t){const l=i.slice();return l[24]=e[t],l[21]=t,l}function ft(i){let e,t;return{c(){e=C("circle"),this.h()},l(l){e=w(l,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0}),k(e).forEach(d),this.h()},h(){o(e,"r",i[6]),o(e,"fill","none"),o(e,"stroke",t=i[19].color),o(e,"stroke-width","0.1"),o(e,"class","svelte-1aszhlb")},m(l,n){v(l,e,n)},p(l,n){n&2&&t!==(t=l[19].color)&&o(e,"stroke",t)},d(l){l&&d(e)}}}function ut(i){let e,t=R(Array(i[19].numRings)),l=[];for(let n=0;n<t.length;n+=1)l[n]=Me(Se(i,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=P()},l(n){for(let s=0;s<l.length;s+=1)l[s].l(n);e=P()},m(n,s){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,s);v(n,e,s)},p(n,s){if(s&194){t=R(Array(n[19].numRings));let r;for(r=0;r<t.length;r+=1){const a=Se(n,t,r);l[r]?l[r].p(a,s):(l[r]=Me(a),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&d(e),ae(l,n)}}}function Me(i){let e,t;return{c(){e=C("circle"),this.h()},l(l){e=w(l,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0}),k(e).forEach(d),this.h()},h(){o(e,"r",i[6]+i[21]*i[7]),o(e,"fill","none"),o(e,"stroke",t=i[19].color),o(e,"stroke-width","0.1"),o(e,"class","svelte-1aszhlb")},m(l,n){v(l,e,n)},p(l,n){n&2&&t!==(t=l[19].color)&&o(e,"stroke",t)},d(l){l&&d(e)}}}function Ne(i,e){let t,l;function n(a,c){return a[19].numRings>0?ut:ft}let s=n(e),r=s(e);return{key:i,first:null,c(){t=C("g"),r.c(),this.h()},l(a){t=w(a,"g",{class:!0,transform:!0});var c=k(t);r.l(c),c.forEach(d),this.h()},h(){o(t,"class","node svelte-1aszhlb"),o(t,"transform",l="translate("+e[19].x+", "+e[19].y+")"),this.first=t},m(a,c){v(a,t,c),r.m(t,null)},p(a,c){e=a,s===(s=n(e))&&r?r.p(e,c):(r.d(1),r=s(e),r&&(r.c(),r.m(t,null))),c&2&&l!==(l="translate("+e[19].x+", "+e[19].y+")")&&o(t,"transform",l)},d(a){a&&d(t),r.d()}}}function ze(i){let e,t,l,n,s=R(i[2].slice(0,i[2].length-1)),r=[];for(let a=0;a<s.length;a+=1)r[a]=Le(De(i,s,a));return{c(){e=C("g"),t=C("defs"),l=C("marker"),n=C("polygon");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=w(a,"g",{class:!0});var c=k(e);t=w(c,"defs",{});var f=k(t);l=w(f,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var u=k(l);n=w(u,"polygon",{points:!0,fill:!0}),k(n).forEach(d),u.forEach(d),f.forEach(d);for(let g=0;g<r.length;g+=1)r[g].l(c);c.forEach(d),this.h()},h(){o(n,"points","0 0, 6 2, 0 4"),o(n,"fill","blue"),o(l,"id","arrowhead"),o(l,"markerWidth","6"),o(l,"markerHeight","4"),o(l,"refX","3"),o(l,"refY","2"),o(l,"orient","auto"),o(e,"class","curator-path svelte-1aszhlb")},m(a,c){v(a,e,c),b(e,t),b(t,l),b(l,n);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null)},p(a,c){if(c&4){s=R(a[2].slice(0,a[2].length-1));let f;for(f=0;f<s.length;f+=1){const u=De(a,s,f);r[f]?r[f].p(u,c):(r[f]=Le(u),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}},d(a){a&&d(e),ae(r,a)}}}function Ie(i){let e,t;return{c(){e=C("path"),this.h()},l(l){e=w(l,"path",{d:!0,fill:!0,stroke:!0,"stroke-width":!0,"marker-end":!0,class:!0}),k(e).forEach(d),this.h()},h(){o(e,"d",t=Ye(i[19],i[2][i[21]+1])),o(e,"fill","none"),o(e,"stroke","blue"),o(e,"stroke-width",".5"),o(e,"marker-end","url(#arrowhead)"),o(e,"class","svelte-1aszhlb")},m(l,n){v(l,e,n)},p(l,n){n&4&&t!==(t=Ye(l[19],l[2][l[21]+1]))&&o(e,"d",t)},d(l){l&&d(e)}}}function Le(i){let e,t=i[2][i[21]+1]&&Ie(i);return{c(){t&&t.c(),e=P()},l(l){t&&t.l(l),e=P()},m(l,n){t&&t.m(l,n),v(l,e,n)},p(l,n){l[2][l[21]+1]?t?t.p(l,n):(t=Ie(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&d(e),t&&t.d(l)}}}function ht(i){let e,t,l,n=[],s=new Map,r,a,c;l=new ct({props:{transform:i[5],xScale:i[3],yScale:i[4]}});let f=R(i[1]);const u=_=>_[19].id;for(let _=0;_<f.length;_+=1){let h=Ee(i,f,_),m=u(h);s.set(m,n[_]=Ne(m,h))}let g=i[2].length>1&&ze(i);return{c(){e=C("svg"),t=C("g"),ne(l.$$.fragment);for(let _=0;_<n.length;_+=1)n[_].c();r=P(),g&&g.c(),this.h()},l(_){e=w(_,"svg",{style:!0,class:!0});var h=k(e);t=w(h,"g",{transform:!0});var m=k(t);re(l.$$.fragment,m);for(let x=0;x<n.length;x+=1)n[x].l(m);r=P(),g&&g.l(m),m.forEach(d),h.forEach(d),this.h()},h(){o(t,"transform",a="translate("+i[5].x+", "+i[5].y+") scale("+i[5].k+")"),_e(e,"width","100%"),_e(e,"height","100vh"),o(e,"class","svelte-1aszhlb")},m(_,h){v(_,e,h),b(e,t),le(l,t,null);for(let m=0;m<n.length;m+=1)n[m]&&n[m].m(t,null);b(t,r),g&&g.m(t,null),i[11](e),c=!0},p(_,[h]){const m={};h&32&&(m.transform=_[5]),h&8&&(m.xScale=_[3]),h&16&&(m.yScale=_[4]),l.$set(m),h&194&&(f=R(_[1]),n=oe(n,h,u,1,_,f,s,t,ce,Ne,r,Ee)),_[2].length>1?g?g.p(_,h):(g=ze(_),g.c(),g.m(t,null)):g&&(g.d(1),g=null),(!c||h&32&&a!==(a="translate("+_[5].x+", "+_[5].y+") scale("+_[5].k+")"))&&o(t,"transform",a)},i(_){c||(j(l.$$.fragment,_),c=!0)},o(_){B(l.$$.fragment,_),c=!1},d(_){_&&d(e),te(l);for(let h=0;h<n.length;h+=1)n[h].d();g&&g.d(),i[11](null)}}}const Pe=1,Re=1,xe=10,Ae=5;function _t(i){return"DarkSeaGreen"}function Ye(i,e,t=20){const l=e.x-i.x,n=e.y-i.y,s=(i.x+e.x)/2,r=(i.y+e.y)/2,a=Math.sqrt(l*l+n*n)||1,c=-n/a,f=l/a,u=s+c*t,g=r+f*t;return`M ${i.x} ${i.y} Q ${u} ${g} ${e.x} ${e.y}`}function dt(i,e,t){let l,{data:n=[]}=e,{currentYear:s}=e,{selectedCuratorData:r=null}=e,a,c=[],f,u,g=ke,_;const h=Pe+(xe-1)*Re,m=Ae/2/h,x=Pe*m,O=Re*m,z=h*m,y=Ae;function D(){a.clientWidth,a.clientHeight;const p=n.map(L=>parseFloat(L.LONGITUDE)).filter(L=>!isNaN(L)),M=n.map(L=>parseFloat(L.LATITUDE)).filter(L=>!isNaN(L));let S=pe(p),N=ye(p),Y=pe(M),I=ye(M);const q=(N-S)*.2,T=(I-Y)*.2;S-=q,N+=q,Y-=T,I+=T,t(3,f=be().domain([S,N]).range([0,a.clientWidth])),t(4,u=be().domain([Y,I]).range([a.clientHeight,0]))}function E(){return!n||!a||s===void 0?[]:(D(),n.map((M,S)=>{const N=parseFloat(M.LONGITUDE),Y=parseFloat(M.LATITUDE),I=parseInt(M.ACC_YR),q=parseInt(M.last_date);if(isNaN(N)||isNaN(Y)||isNaN(I)||isNaN(q))return null;let T=0;s>=I&&(T=Math.floor((s-I)/10),T=Math.min(T,xe));let L=T>0?x+(T-1)*O:x;L=Math.min(L,z);const G=f(N),V=u(Y),Ke=Math.floor(G/y),Ze=Math.floor(V/y),$e=Ke*y+y/2,et=Ze*y+y/2;return{id:M.PLANTID?M.PLANTID:S,x:$e,y:et,accYear:I,lastDate:q,numRings:T,outerRadius:L,color:_t()}}).filter(Boolean))}ie(()=>{_=at().scaleExtent([2,14]).on("zoom",q=>{t(5,g=q.transform)}),me(a).call(_);const p=a.clientWidth,M=a.clientHeight,S=2,N=p/2-S*(p/1.8),Y=M/2-S*(M/2.5),I=ke.translate(N,Y).scale(S);me(a).call(_.transform,I),t(5,g=I)});function A(p){Xe[p?"unshift":"push"](()=>{a=p,t(0,a)})}return i.$$set=p=>{"data"in p&&t(8,n=p.data),"currentYear"in p&&t(9,s=p.currentYear),"selectedCuratorData"in p&&t(10,r=p.selectedCuratorData)},i.$$.update=()=>{if(i.$$.dirty&769&&n&&a&&s!==void 0&&t(1,c=E()),i.$$.dirty&1030&&r&&r.PlantDates){const M=[...r.PlantDates].sort((S,N)=>S.Date-N.Date).map(S=>String(S.PlantID).toLowerCase());t(2,l=c.filter(S=>M.includes(String(S.id).toLowerCase()))),l.sort((S,N)=>M.indexOf(String(S.id).toLowerCase())-M.indexOf(String(N.id).toLowerCase()))}},t(2,l=[]),[a,c,l,f,u,g,x,O,n,s,r,A]}class gt extends K{constructor(e){super(),Z(this,e,dt,ht,J,{data:8,currentYear:9,selectedCuratorData:10})}}function Te(i,e,t){const l=i.slice();return l[2]=e[t],l[4]=t,l}function mt(i){let e,t="1",l,n;return{c(){e=C("text"),l=W(t),n=W(` year
          `),this.h()},l(s){e=w(s,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0});var r=k(e);l=F(r,t),n=F(r,` year
          `),r.forEach(d),this.h()},h(){o(e,"x","25"),o(e,"y",-(fe+i[4]*ue)),o(e,"dy","1.2em"),o(e,"text-anchor","middle"),o(e,"fill","black"),o(e,"font-size","10")},m(s,r){v(s,e,r),b(e,l),b(e,n)},p:H,d(s){s&&d(e)}}}function kt(i){let e,t=i[4]*10+"",l,n;return{c(){e=C("text"),l=W(t),n=W(` years
          `),this.h()},l(s){e=w(s,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0});var r=k(e);l=F(r,t),n=F(r,` years
          `),r.forEach(d),this.h()},h(){o(e,"x","25"),o(e,"y",-(fe+i[4]*ue)),o(e,"dy","1.2em"),o(e,"text-anchor","middle"),o(e,"fill","black"),o(e,"font-size","10")},m(s,r){v(s,e,r),b(e,l),b(e,n)},p:H,d(s){s&&d(e)}}}function Fe(i){let e,t;function l(r,a){return r[4]>0?kt:mt}let s=l(i)(i);return{c(){e=C("circle"),s.c(),t=P(),this.h()},l(r){e=w(r,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0}),k(e).forEach(d),s.l(r),t=P(),this.h()},h(){o(e,"r",fe+i[4]*ue),o(e,"fill","none"),o(e,"stroke","#888"),o(e,"stroke-width","1")},m(r,a){v(r,e,a),s.m(r,a),v(r,t,a)},p(r,a){s.p(r,a)},d(r){r&&(d(e),d(t)),s.d(r)}}}function pt(i){let e,t,l,n=R(Array(We+1)),s=[];for(let r=0;r<n.length;r+=1)s[r]=Fe(Te(i,n,r));return{c(){e=X("div"),t=C("svg"),l=C("g");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=U(r,"DIV",{class:!0});var a=k(e);t=w(a,"svg",{class:!0,width:!0,height:!0});var c=k(t);l=w(c,"g",{transform:!0});var f=k(l);for(let u=0;u<s.length;u+=1)s[u].l(f);f.forEach(d),c.forEach(d),a.forEach(d),this.h()},h(){o(l,"transform","translate(75, 60)"),o(t,"class","infographic"),o(t,"width","150"),o(t,"height","120"),o(e,"class","legend-container svelte-lugs7g")},m(r,a){v(r,e,a),b(e,t),b(t,l);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(l,null)},p(r,[a]){if(a&0){n=R(Array(We+1));let c;for(c=0;c<n.length;c+=1){const f=Te(r,n,c);s[c]?s[c].p(f,a):(s[c]=Fe(f),s[c].c(),s[c].m(l,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},i:H,o:H,d(r){r&&d(e),ae(s,r)}}}const We=4,fe=10,ue=20;function yt(i,e,t){let{classColorMapping:l}=e;return i.$$set=n=>{"classColorMapping"in n&&t(0,l=n.classColorMapping)},[l]}class bt extends K{constructor(e){super(),Z(this,e,yt,pt,J,{classColorMapping:0})}}function je(i,e,t){const l=i.slice();return l[7]=e[t],l}function qe(i,e,t){const l=i.slice();return l[11]=e[t],l}function se(i){const e=i.slice(),t=Dt(e[7]);return e[10]=t,e}function Ge(i){let e,t,l,n=i[10].minDate+"",s,r,a=i[10].maxDate+"",c,f,u=i[10].count+"",g,_,h=i[10].count===1?"":"s",m;function x(y,D){return y[10].maxDate!==y[10].minDate?wt:vt}let O=x(i),z=O(i);return{c(){e=C("svg"),t=C("line"),z.c(),l=C("text"),s=W(n),r=C("text"),c=W(a),f=C("text"),g=W(u),_=W(" annotation"),m=W(h),this.h()},l(y){e=w(y,"svg",{class:!0,width:!0,height:!0});var D=k(e);t=w(D,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,class:!0}),k(t).forEach(d),z.l(D),l=w(D,"text",{x:!0,y:!0,"font-size":!0,fill:!0,class:!0});var E=k(l);s=F(E,n),E.forEach(d),r=w(D,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var A=k(r);c=F(A,a),A.forEach(d),f=w(D,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var p=k(f);g=F(p,u),_=F(p," annotation"),m=F(p,h),p.forEach(d),D.forEach(d),this.h()},h(){o(t,"x1","10"),o(t,"y1","20"),o(t,"x2","280"),o(t,"y2","20"),o(t,"stroke","#ccc"),o(t,"stroke-width","2"),o(t,"class","svelte-14kd2y1"),o(l,"x","10"),o(l,"y","15"),o(l,"font-size","10"),o(l,"fill","#333"),o(l,"class","svelte-14kd2y1"),o(r,"x","280"),o(r,"y","15"),o(r,"font-size","10"),o(r,"fill","#333"),o(r,"text-anchor","end"),o(r,"class","svelte-14kd2y1"),o(f,"x","100"),o(f,"y","35"),o(f,"font-size","10"),o(f,"fill","#333"),o(f,"text-anchor","middle"),o(f,"class","svelte-14kd2y1"),o(e,"class","histogram svelte-14kd2y1"),o(e,"width","320"),o(e,"height","40")},m(y,D){v(y,e,D),b(e,t),z.m(e,null),b(e,l),b(l,s),b(e,r),b(r,c),b(e,f),b(f,g),b(f,_),b(f,m)},p(y,D){O===(O=x(y))&&z?z.p(y,D):(z.d(1),z=O(y),z&&(z.c(),z.m(e,l))),D&1&&n!==(n=y[10].minDate+"")&&Q(s,n),D&1&&a!==(a=y[10].maxDate+"")&&Q(c,a),D&1&&u!==(u=y[10].count+"")&&Q(g,u),D&1&&h!==(h=y[10].count===1?"":"s")&&Q(m,h)},d(y){y&&d(e),z.d()}}}function vt(i){let e;return{c(){e=C("circle"),this.h()},l(t){e=w(t,"circle",{cx:!0,cy:!0,r:!0,fill:!0,class:!0}),k(e).forEach(d),this.h()},h(){o(e,"cx","100"),o(e,"cy","20"),o(e,"r","4"),o(e,"fill","blue"),o(e,"class","svelte-14kd2y1")},m(t,l){v(t,e,l)},p:H,d(t){t&&d(e)}}}function wt(i){let e,t=R(i[10].dates),l=[];for(let n=0;n<t.length;n+=1)l[n]=He(qe(i,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=P()},l(n){for(let s=0;s<l.length;s+=1)l[s].l(n);e=P()},m(n,s){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,s);v(n,e,s)},p(n,s){if(s&1){t=R(n[10].dates);let r;for(r=0;r<t.length;r+=1){const a=qe(n,t,r);l[r]?l[r].p(a,s):(l[r]=He(a),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&d(e),ae(l,n)}}}function He(i){let e,t;return{c(){e=C("circle"),this.h()},l(l){e=w(l,"circle",{cx:!0,cy:!0,r:!0,fill:!0,class:!0}),k(e).forEach(d),this.h()},h(){o(e,"cx",t=Ve(i[11],i[10].minDate,i[10].maxDate)),o(e,"cy","20"),o(e,"r","2"),o(e,"fill","blue"),o(e,"class","svelte-14kd2y1")},m(l,n){v(l,e,n)},p(l,n){n&1&&t!==(t=Ve(l[11],l[10].minDate,l[10].maxDate))&&o(e,"cx",t)},d(l){l&&d(e)}}}function Oe(i,e){let t,l,n=e[7].CuratorName+"",s,r,a,c,f,u=e[7].PlantDates&&e[7].PlantDates.length>0&&Ge(se(e));function g(){return e[5](e[7])}return{key:i,first:null,c(){t=X("li"),l=X("div"),s=W(n),r=ee(),u&&u.c(),a=ee(),this.h()},l(_){t=U(_,"LI",{class:!0});var h=k(t);l=U(h,"DIV",{class:!0});var m=k(l);s=F(m,n),m.forEach(d),r=$(h),u&&u.l(h),a=$(h),h.forEach(d),this.h()},h(){o(l,"class","curator-name svelte-14kd2y1"),o(t,"class","svelte-14kd2y1"),de(t,"selected",e[7].CuratorName===e[1]),this.first=t},m(_,h){v(_,t,h),b(t,l),b(l,s),b(t,r),u&&u.m(t,null),b(t,a),c||(f=lt(t,"click",g),c=!0)},p(_,h){e=_,h&1&&n!==(n=e[7].CuratorName+"")&&Q(s,n),e[7].PlantDates&&e[7].PlantDates.length>0?u?u.p(se(e),h):(u=Ge(se(e)),u.c(),u.m(t,a)):u&&(u.d(1),u=null),h&3&&de(t,"selected",e[7].CuratorName===e[1])},d(_){_&&d(t),u&&u.d(),c=!1,f()}}}function Ct(i){let e,t,l=[],n=new Map,s=R(i[0]);const r=a=>a[7].CuratorName;for(let a=0;a<s.length;a+=1){let c=je(i,s,a),f=r(c);n.set(f,l[a]=Oe(f,c))}return{c(){e=X("aside"),t=X("ul");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=U(a,"ASIDE",{class:!0});var c=k(e);t=U(c,"UL",{class:!0});var f=k(t);for(let u=0;u<l.length;u+=1)l[u].l(f);f.forEach(d),c.forEach(d),this.h()},h(){o(t,"class","svelte-14kd2y1"),o(e,"class","curator-sidebar svelte-14kd2y1")},m(a,c){v(a,e,c),b(e,t);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(t,null)},p(a,[c]){c&7&&(s=R(a[0]),l=oe(l,c,r,1,a,s,n,t,ce,Oe,null,je))},i:H,o:H,d(a){a&&d(e);for(let c=0;c<l.length;c+=1)l[c].d()}}}function Dt(i){const e=i.PlantDates.map(n=>n.Date),t=Math.min(...e),l=Math.max(...e);return{minDate:t,maxDate:l,count:e.length,dates:e}}function Ve(i,e,t){return t===e?100:10+(i-e)/(t-e)*180}function Et(i,e,t){let l,n,{curatorData:s=[]}=e,{initialCurator:r=""}=e;const a=tt();function c(u){t(1,n=u);const g=s.find(_=>_.CuratorName.toLowerCase()===u.toLowerCase());a("curatorChange",{selectedCuratorData:g})}const f=u=>c(u.CuratorName);return i.$$set=u=>{"curatorData"in u&&t(3,s=u.curatorData),"initialCurator"in u&&t(4,r=u.initialCurator)},i.$$.update=()=>{i.$$.dirty&8&&t(0,l=s.slice().sort((u,g)=>u.CuratorName.localeCompare(g.CuratorName))),i.$$.dirty&17&&t(1,n=r||(l.length>0?l[0]:""))},[l,n,c,s,r,f]}class St extends K{constructor(e){super(),Z(this,e,Et,Ct,J,{curatorData:3,initialCurator:4})}}function Be(i){let e,t,l,n,s,r=i[1].length>0&&Ue(i);return n=new St({props:{curatorData:i[0]}}),n.$on("curatorChange",i[4]),{c(){e=X("div"),t=X("div"),r&&r.c(),l=ee(),ne(n.$$.fragment),this.h()},l(a){e=U(a,"DIV",{class:!0});var c=k(e);t=U(c,"DIV",{class:!0});var f=k(t);r&&r.l(f),f.forEach(d),l=$(c),re(n.$$.fragment,c),c.forEach(d),this.h()},h(){o(t,"class","main svelte-dgiw5l"),o(e,"class","container svelte-dgiw5l")},m(a,c){v(a,e,c),b(e,t),r&&r.m(t,null),b(e,l),le(n,e,null),s=!0},p(a,c){a[1].length>0?r?(r.p(a,c),c&2&&j(r,1)):(r=Ue(a),r.c(),j(r,1),r.m(t,null)):r&&(Je(),B(r,1,1,()=>{r=null}),Qe());const f={};c&1&&(f.curatorData=a[0]),n.$set(f)},i(a){s||(j(r),j(n.$$.fragment,a),s=!0)},o(a){B(r),B(n.$$.fragment,a),s=!1},d(a){a&&d(e),r&&r.d(),te(n)}}}function Ue(i){let e,t,l,n;return e=new gt({props:{data:i[1],currentYear:i[2],selectedCuratorData:i[3]}}),l=new bt({props:{classColorMapping:i[5]}}),{c(){ne(e.$$.fragment),t=ee(),ne(l.$$.fragment)},l(s){re(e.$$.fragment,s),t=$(s),re(l.$$.fragment,s)},m(s,r){le(e,s,r),v(s,t,r),le(l,s,r),n=!0},p(s,r){const a={};r&2&&(a.data=s[1]),r&4&&(a.currentYear=s[2]),r&8&&(a.selectedCuratorData=s[3]),e.$set(a)},i(s){n||(j(e.$$.fragment,s),j(l.$$.fragment,s),n=!0)},o(s){B(e.$$.fragment,s),B(l.$$.fragment,s),n=!1},d(s){s&&d(t),te(e,s),te(l,s)}}}function Mt(i){let e,t,l=i[1].length>0&&i[0].length>0&&Be(i);return{c(){l&&l.c(),e=P()},l(n){l&&l.l(n),e=P()},m(n,s){l&&l.m(n,s),v(n,e,s),t=!0},p(n,[s]){n[1].length>0&&n[0].length>0?l?(l.p(n,s),s&3&&j(l,1)):(l=Be(n),l.c(),j(l,1),l.m(e.parentNode,e)):l&&(Je(),B(l,1,1,()=>{l=null}),Qe())},i(n){t||(j(l),t=!0)},o(n){B(l),t=!1},d(n){n&&d(e),l&&l.d(n)}}}function Nt(i,e,t){let l=[],n=[],s=2011,r,a=null;ie(async()=>{const u=await fetch("data/ArnArbPlantsGEO.json");t(1,l=await u.json()),Math.min(...l.map(_=>parseInt(_.ACC_YR))),r=Math.max(...l.map(_=>parseInt(_.ACC_YR))),t(2,s=r);const g=await fetch("data/Curator_Plants_Dates.json");t(0,n=await g.json()),n.length>0&&t(3,a=n[0])});function c(u){t(3,a=u.detail.selectedCuratorData)}const f={Eudicot:"#d7191c",Ginkgoopsida:"#fdae61",Monocot:"#ffffbf",Lycopodiopsida:"#abdda4",Pinopsida:"#2b83ba"};return i.$$.update=()=>{i.$$.dirty&1&&console.log(n)},[n,l,s,a,c,f]}class Pt extends K{constructor(e){super(),Z(this,e,Nt,Mt,J,{})}}export{Pt as component};
