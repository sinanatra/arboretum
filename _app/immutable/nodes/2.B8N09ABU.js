import{s as pe,n as de,d as m,i as S,p as X,r as Ze,O as w,h as k,P as D,z as Gt,x as u,Q as $e,R as le,e as y,f as B,k as J,S as cn,l as H,m as x,j as K,t as $,y as Je,T as un,U as xe,V as fn,b as be}from"../chunks/C2CFgrAZ.js";import{S as me,i as ve,d as Pe,t as G,a as z,m as Ne,e as Re,b as Ie,c as Ae,g as Fe}from"../chunks/w_dtK-mc.js";import{e as P,u as Xt,d as jt,z as hn,s as et,i as tt,m as nt,a as rt,l as lt}from"../chunks/PMpw4u_E.js";class ie{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let t=0;for(let l=0;l<this._n&&l<32;l++){const a=n[l],i=e+a,s=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);s&&(n[t++]=s),e=i}return n[t]=e,this._n=t+1,this}valueOf(){const e=this._partials;let n=this._n,t,l,a,i=0;if(n>0){for(i=e[--n];n>0&&(t=i,l=e[--n],i=t+l,a=l-(i-t),!a););n>0&&(a<0&&e[n-1]<0||a>0&&e[n-1]>0)&&(l=a*2,t=i+l,l==t-i&&(i=t))}return i}}var dn=Math.PI,gn=dn*2,_n=Math.abs,Qe=Math.sqrt;function V(){}function Ee(r,e){r&&at.hasOwnProperty(r.type)&&at[r.type](r,e)}var it={Feature:function(r,e){Ee(r.geometry,e)},FeatureCollection:function(r,e){for(var n=r.features,t=-1,l=n.length;++t<l;)Ee(n[t].geometry,e)}},at={Sphere:function(r,e){e.sphere()},Point:function(r,e){r=r.coordinates,e.point(r[0],r[1],r[2])},MultiPoint:function(r,e){for(var n=r.coordinates,t=-1,l=n.length;++t<l;)r=n[t],e.point(r[0],r[1],r[2])},LineString:function(r,e){Oe(r.coordinates,e,0)},MultiLineString:function(r,e){for(var n=r.coordinates,t=-1,l=n.length;++t<l;)Oe(n[t],e,0)},Polygon:function(r,e){st(r.coordinates,e)},MultiPolygon:function(r,e){for(var n=r.coordinates,t=-1,l=n.length;++t<l;)st(n[t],e)},GeometryCollection:function(r,e){for(var n=r.geometries,t=-1,l=n.length;++t<l;)Ee(n[t],e)}};function Oe(r,e,n){var t=-1,l=r.length-n,a;for(e.lineStart();++t<l;)a=r[t],e.point(a[0],a[1],a[2]);e.lineEnd()}function st(r,e){var n=-1,t=r.length;for(e.polygonStart();++n<t;)Oe(r[n],e,1);e.polygonEnd()}function oe(r,e){r&&it.hasOwnProperty(r.type)?it[r.type](r,e):Ee(r,e)}const pn=r=>r;var ze=new ie,qe=new ie,Zt,Qt,Ve,Be,j={point:V,lineStart:V,lineEnd:V,polygonStart:function(){j.lineStart=mn,j.lineEnd=kn},polygonEnd:function(){j.lineStart=j.lineEnd=j.point=V,ze.add(_n(qe)),qe=new ie},result:function(){var r=ze/2;return ze=new ie,r}};function mn(){j.point=vn}function vn(r,e){j.point=Kt,Zt=Ve=r,Qt=Be=e}function Kt(r,e){qe.add(Be*r-Ve*e),Ve=r,Be=e}function kn(){Kt(Zt,Qt)}var ae=1/0,we=ae,ge=-ae,De=ge,ot={point:yn,lineStart:V,lineEnd:V,polygonStart:V,polygonEnd:V,result:function(){var r=[[ae,we],[ge,De]];return ge=De=-(we=ae=1/0),r}};function yn(r,e){r<ae&&(ae=r),r>ge&&(ge=r),e<we&&(we=e),e>De&&(De=e)}var He=0,Ue=0,ce=0,Se=0,Ce=0,re=0,We=0,Ge=0,ue=0,$t,Jt,U,W,O={point:ee,lineStart:ct,lineEnd:ut,polygonStart:function(){O.lineStart=wn,O.lineEnd=Dn},polygonEnd:function(){O.point=ee,O.lineStart=ct,O.lineEnd=ut},result:function(){var r=ue?[We/ue,Ge/ue]:re?[Se/re,Ce/re]:ce?[He/ce,Ue/ce]:[NaN,NaN];return He=Ue=ce=Se=Ce=re=We=Ge=ue=0,r}};function ee(r,e){He+=r,Ue+=e,++ce}function ct(){O.point=bn}function bn(r,e){O.point=En,ee(U=r,W=e)}function En(r,e){var n=r-U,t=e-W,l=Qe(n*n+t*t);Se+=l*(U+r)/2,Ce+=l*(W+e)/2,re+=l,ee(U=r,W=e)}function ut(){O.point=ee}function wn(){O.point=Sn}function Dn(){xt($t,Jt)}function Sn(r,e){O.point=xt,ee($t=U=r,Jt=W=e)}function xt(r,e){var n=r-U,t=e-W,l=Qe(n*n+t*t);Se+=l*(U+r)/2,Ce+=l*(W+e)/2,re+=l,l=W*r-U*e,We+=l*(U+r),Ge+=l*(W+e),ue+=l*3,ee(U=r,W=e)}function en(r){this._context=r}en.prototype={_radius:4.5,pointRadius:function(r){return this._radius=r,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(r,e){switch(this._point){case 0:{this._context.moveTo(r,e),this._point=1;break}case 1:{this._context.lineTo(r,e);break}default:{this._context.moveTo(r+this._radius,e),this._context.arc(r,e,this._radius,0,gn);break}}},result:V};var Xe=new ie,Te,tn,nn,fe,he,_e={point:V,lineStart:function(){_e.point=Cn},lineEnd:function(){Te&&rn(tn,nn),_e.point=V},polygonStart:function(){Te=!0},polygonEnd:function(){Te=null},result:function(){var r=+Xe;return Xe=new ie,r}};function Cn(r,e){_e.point=rn,tn=fe=r,nn=he=e}function rn(r,e){fe-=r,he-=e,Xe.add(Qe(fe*fe+he*he)),fe=r,he=e}let ft,Me,ht,dt;class gt{constructor(e){this._append=e==null?ln:Mn(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==ht||this._append!==Me){const t=this._radius,l=this._;this._="",this._append`m0,${t}a${t},${t} 0 1,1 0,${-2*t}a${t},${t} 0 1,1 0,${2*t}z`,ht=t,Me=this._append,dt=this._,this._=l}this._+=dt;break}}}result(){const e=this._;return this._="",e.length?e:null}}function ln(r){let e=1;this._+=r[0];for(const n=r.length;e<n;++e)this._+=arguments[e]+r[e]}function Mn(r){const e=Math.floor(r);if(!(e>=0))throw new RangeError(`invalid digits: ${r}`);if(e>15)return ln;if(e!==ft){const n=10**e;ft=e,Me=function(l){let a=1;this._+=l[0];for(const i=l.length;a<i;++a)this._+=Math.round(arguments[a]*n)/n+l[a]}}return Me}function Pn(r,e){let n=3,t=4.5,l,a;function i(s){return s&&(typeof t=="function"&&a.pointRadius(+t.apply(this,arguments)),oe(s,l(a))),a.result()}return i.area=function(s){return oe(s,l(j)),j.result()},i.measure=function(s){return oe(s,l(_e)),_e.result()},i.bounds=function(s){return oe(s,l(ot)),ot.result()},i.centroid=function(s){return oe(s,l(O)),O.result()},i.projection=function(s){return arguments.length?(l=s==null?(r=null,pn):(r=s).stream,i):r},i.context=function(s){return arguments.length?(a=s==null?(e=null,new gt(n)):new en(e=s),typeof t!="function"&&a.pointRadius(t),i):e},i.pointRadius=function(s){return arguments.length?(t=typeof s=="function"?s:(a.pointRadius(+s),+s),i):t},i.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const c=Math.floor(s);if(!(c>=0))throw new RangeError(`invalid digits: ${s}`);n=c}return e===null&&(a=new gt(n)),i},i.projection(r).digits(n).context(e)}function Nn(r){return{stream:Rn(r)}}function Rn(r){return function(e){var n=new je;for(var t in r)n[t]=r[t];return n.stream=e,n}}function je(){}je.prototype={constructor:je,point:function(r,e){this.stream.point(r,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _t(r,e,n){const t=r.slice();return t[7]=e[n],t[9]=n,t}function pt(r){let e,n=[],t=new Map,l=P(r[0].features);const a=i=>i[7].id||i[9];for(let i=0;i<l.length;i+=1){let s=_t(r,l,i),c=a(s);t.set(c,n[i]=mt(c,s))}return{c(){e=D("g");for(let i=0;i<n.length;i+=1)n[i].c()},l(i){e=w(i,"g",{});var s=k(e);for(let c=0;c<n.length;c+=1)n[c].l(s);s.forEach(m)},m(i,s){S(i,e,s);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);r[6](e)},p(i,s){s&3&&(l=P(i[0].features),n=Xt(n,s,a,1,i,l,t,e,jt,mt,null,_t))},d(i){i&&m(e);for(let s=0;s<n.length;s+=1)n[s].d();r[6](null)}}}function mt(r,e){let n,t,l;return{key:r,first:null,c(){n=D("path"),this.h()},l(a){n=w(a,"path",{d:!0,class:!0}),k(n).forEach(m),this.h()},h(){u(n,"d",t=e[1](e[7])),u(n,"class",l=$e("pixel "+e[7].properties.type)+" svelte-1bv6vkc"),this.first=n},m(a,i){S(a,n,i)},p(a,i){e=a,i&3&&t!==(t=e[1](e[7]))&&u(n,"d",t),i&1&&l!==(l=$e("pixel "+e[7].properties.type)+" svelte-1bv6vkc")&&u(n,"class",l)},d(a){a&&m(n)}}}function In(r){let e,n=r[0]&&r[1]&&pt(r);return{c(){n&&n.c(),e=X()},l(t){n&&n.l(t),e=X()},m(t,l){n&&n.m(t,l),S(t,e,l)},p(t,[l]){t[0]&&t[1]?n?n.p(t,l):(n=pt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:de,o:de,d(t){t&&m(e),n&&n.d(t)}}}function Yn(r,e,n){let{xScale:t}=e,{yScale:l}=e,{transform:a={x:0,y:0,k:1}}=e,i=null,s=null,c;Ze(async()=>{try{const o=await fetch("pixelated.geojson");n(0,i=await o.json()),console.log("Loaded pixelated geojson:",i.features.length,"features");const _=Nn({point(g,d){this.stream.point(t(g),l(d))}});n(1,s=Pn().projection(_))}catch(o){console.error("Error loading pixelated.geojson",o)}});function f(o){Gt[o?"unshift":"push"](()=>{c=o,n(2,c)})}return r.$$set=o=>{"xScale"in o&&n(3,t=o.xScale),"yScale"in o&&n(4,l=o.yScale),"transform"in o&&n(5,a=o.transform)},[i,s,c,t,l,a,f]}class zn extends me{constructor(e){super(),ve(this,e,Yn,In,pe,{xScale:3,yScale:4,transform:5})}}function vt(r,e,n){const t=r.slice();return t[21]=e[n],t[23]=n,t}function kt(r,e,n){const t=r.slice();return t[21]=e[n],t}function yt(r,e,n){const t=r.slice();return t[26]=e[n],t[23]=n,t}function Tn(r){let e,n;return{c(){e=D("circle"),this.h()},l(t){e=w(t,"circle",{r:!0,fill:!0,stroke:!0,class:!0}),k(e).forEach(m),this.h()},h(){u(e,"r",r[6]),u(e,"fill","none"),u(e,"stroke",n=r[8](r[21].plantType)),u(e,"class","node-ring svelte-163ibqd")},m(t,l){S(t,e,l)},p(t,l){l&2&&n!==(n=t[8](t[21].plantType))&&u(e,"stroke",n)},d(t){t&&m(e)}}}function Ln(r){let e,n=P(Array(r[21].numRings)),t=[];for(let l=0;l<n.length;l+=1)t[l]=bt(yt(r,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=X()},l(l){for(let a=0;a<t.length;a+=1)t[a].l(l);e=X()},m(l,a){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(l,a);S(l,e,a)},p(l,a){if(a&450){n=P(Array(l[21].numRings));let i;for(i=0;i<n.length;i+=1){const s=yt(l,n,i);t[i]?t[i].p(s,a):(t[i]=bt(s),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=n.length}},d(l){l&&m(e),le(t,l)}}}function bt(r){let e,n;return{c(){e=D("circle"),this.h()},l(t){e=w(t,"circle",{r:!0,fill:!0,stroke:!0,class:!0}),k(e).forEach(m),this.h()},h(){u(e,"r",r[6]+r[23]*r[7]),u(e,"fill","none"),u(e,"stroke",n=r[8](r[21].plantType)),u(e,"class","node-ring svelte-163ibqd")},m(t,l){S(t,e,l)},p(t,l){l&2&&n!==(n=t[8](t[21].plantType))&&u(e,"stroke",n)},d(t){t&&m(e)}}}function Et(r){let e,n;function t(i,s){return i[21].numRings>0?Ln:Tn}let l=t(r),a=l(r);return{c(){e=D("g"),a.c(),this.h()},l(i){e=w(i,"g",{class:!0,transform:!0});var s=k(e);a.l(s),s.forEach(m),this.h()},h(){u(e,"class","node svelte-163ibqd"),u(e,"transform",n="translate("+r[21].x+", "+r[21].y+")")},m(i,s){S(i,e,s),a.m(e,null)},p(i,s){l===(l=t(i))&&a?a.p(i,s):(a.d(1),a=l(i),a&&(a.c(),a.m(e,null))),s&2&&n!==(n="translate("+i[21].x+", "+i[21].y+")")&&u(e,"transform",n)},d(i){i&&m(e),a.d()}}}function wt(r){let e,n,t,l,a=P(r[2].slice(0,r[2].length-1)),i=[];for(let s=0;s<a.length;s+=1)i[s]=St(vt(r,a,s));return{c(){e=D("g"),n=D("defs"),t=D("marker"),l=D("polygon");for(let s=0;s<i.length;s+=1)i[s].c();this.h()},l(s){e=w(s,"g",{class:!0});var c=k(e);n=w(c,"defs",{});var f=k(n);t=w(f,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var o=k(t);l=w(o,"polygon",{points:!0,class:!0}),k(l).forEach(m),o.forEach(m),f.forEach(m);for(let _=0;_<i.length;_+=1)i[_].l(c);c.forEach(m),this.h()},h(){u(l,"points","0 0, 6 2, 0 4"),u(l,"class","arrowhead svelte-163ibqd"),u(t,"id","arrowhead"),u(t,"markerWidth","6"),u(t,"markerHeight","4"),u(t,"refX","3"),u(t,"refY","2"),u(t,"orient","auto"),u(e,"class","curator-path svelte-163ibqd")},m(s,c){S(s,e,c),y(e,n),y(n,t),y(t,l);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(s,c){if(c&4){a=P(s[2].slice(0,s[2].length-1));let f;for(f=0;f<a.length;f+=1){const o=vt(s,a,f);i[f]?i[f].p(o,c):(i[f]=St(o),i[f].c(),i[f].m(e,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=a.length}},d(s){s&&m(e),le(i,s)}}}function Dt(r){let e,n;return{c(){e=D("path"),this.h()},l(t){e=w(t,"path",{d:!0,fill:!0,class:!0,"marker-end":!0}),k(e).forEach(m),this.h()},h(){u(e,"d",n=Rt(r[21],r[2][r[23]+1])),u(e,"fill","none"),u(e,"class","curator-path-line svelte-163ibqd"),u(e,"marker-end","url(#arrowhead)")},m(t,l){S(t,e,l)},p(t,l){l&4&&n!==(n=Rt(t[21],t[2][t[23]+1]))&&u(e,"d",n)},d(t){t&&m(e)}}}function St(r){let e,n=r[2][r[23]+1]&&Dt(r);return{c(){n&&n.c(),e=X()},l(t){n&&n.l(t),e=X()},m(t,l){n&&n.m(t,l),S(t,e,l)},p(t,l){t[2][t[23]+1]?n?n.p(t,l):(n=Dt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){t&&m(e),n&&n.d(t)}}}function An(r){let e,n,t,l,a,i;t=new zn({props:{transform:r[5],xScale:r[3],yScale:r[4]}});let s=P(r[1]),c=[];for(let o=0;o<s.length;o+=1)c[o]=Et(kt(r,s,o));let f=r[2].length>1&&wt(r);return{c(){e=D("svg"),n=D("g"),Ie(t.$$.fragment);for(let o=0;o<c.length;o+=1)c[o].c();l=X(),f&&f.c(),this.h()},l(o){e=w(o,"svg",{class:!0});var _=k(e);n=w(_,"g",{transform:!0});var g=k(n);Re(t.$$.fragment,g);for(let d=0;d<c.length;d+=1)c[d].l(g);l=X(),f&&f.l(g),g.forEach(m),_.forEach(m),this.h()},h(){u(n,"transform",a="translate("+r[5].x+", "+r[5].y+") scale("+r[5].k+")"),u(e,"class","svelte-163ibqd")},m(o,_){S(o,e,_),y(e,n),Ne(t,n,null);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(n,null);y(n,l),f&&f.m(n,null),r[12](e),i=!0},p(o,[_]){const g={};if(_&32&&(g.transform=o[5]),_&8&&(g.xScale=o[3]),_&16&&(g.yScale=o[4]),t.$set(g),_&450){s=P(o[1]);let d;for(d=0;d<s.length;d+=1){const p=kt(o,s,d);c[d]?c[d].p(p,_):(c[d]=Et(p),c[d].c(),c[d].m(n,l))}for(;d<c.length;d+=1)c[d].d(1);c.length=s.length}o[2].length>1?f?f.p(o,_):(f=wt(o),f.c(),f.m(n,null)):f&&(f.d(1),f=null),(!i||_&32&&a!==(a="translate("+o[5].x+", "+o[5].y+") scale("+o[5].k+")"))&&u(n,"transform",a)},i(o){i||(z(t.$$.fragment,o),i=!0)},o(o){G(t.$$.fragment,o),i=!1},d(o){o&&m(e),Pe(t),le(c,o),f&&f.d(),r[12](null)}}}const Ct=1,Mt=1,Pt=10,Nt=4;function Rt(r,e,n=20){const t=e.x-r.x,l=e.y-r.y,a=(r.x+e.x)/2,i=(r.y+e.y)/2,s=Math.sqrt(t*t+l*l)||1,c=-l/s,f=t/s,o=a+c*n,_=i+f*n;return`M ${r.x} ${r.y} Q ${o} ${_} ${e.x} ${e.y}`}function Fn(r,e,n){let{data:t=[]}=e,{currentYear:l}=e,{selectedCuratorData:a=null}=e,i,s=[],c=[],f,o,_=tt,g;const d=Ct+(Pt-1)*Mt,p=Nt/2/d,h=Ct*p,v=Mt*p,b=d*p,C=Nt;function te(){const E=i.clientWidth,q=i.clientHeight,M=t.map(A=>parseFloat(A.LONGITUDE)).filter(A=>!isNaN(A)),T=t.map(A=>parseFloat(A.LATITUDE)).filter(A=>!isNaN(A));let N=nt(M),R=rt(M),I=nt(T),Y=rt(T);const L=(R-N)*.2,Z=(Y-I)*.2;N-=L,R+=L,I-=Z,Y+=Z,n(3,f=lt().domain([N,R]).range([0,E])),n(4,o=lt().domain([I,Y]).range([q,0]))}function se(){if(!t||!i||l===void 0)return[];te();const E=new Map;t.forEach((M,T)=>{const N=parseFloat(M.LONGITUDE),R=parseFloat(M.LATITUDE),I=parseInt(M.ACC_YR);if(parseInt(M.last_date),isNaN(N)||isNaN(R)||isNaN(I))return;let Y=0;l>=I&&(Y=Math.floor((l-I)/10),Y=Math.min(Y,Pt));let L=Y>0?h+(Y-1)*v:h;L=Math.min(L,b);const Z=f(N),A=o(R),ke=Math.floor(Z/C),ne=Math.floor(A/C),Q=`${ke}-${ne}`,Ye=ke*C+C/2,F=ne*C+C/2,ye={plantType:M.KIND_OF_SPECIMEN_FULL,numRings:Y,outerRadius:L,plantID:M.PLANTID?String(M.PLANTID).toLowerCase():String(T)};if(!E.has(Q))E.set(Q,{x:Ye,y:F,records:[ye],count:1});else{const Ke=E.get(Q);Ke.records.push(ye),Ke.count++}});const q=[];return E.forEach((M,T)=>{const{x:N,y:R,records:I}=M,Y=I.length,L={};I.forEach(F=>{L[F.plantType]=(L[F.plantType]||0)+1});let Z=null,A=0;for(let F in L)L[F]>A&&(A=L[F],Z=F);const ke=I.reduce((F,ye)=>F+ye.numRings,0);let ne=Math.floor(ke/Y),Q=ne>0?h+(ne-1)*v:h;Q=Math.min(Q,b);const Ye=I.map(F=>F.plantID);q.push({id:T,x:N,y:R,numRings:ne,outerRadius:Q,plantType:Z,count:Y,plantIDs:Ye})}),q}Ze(()=>{g=hn().scaleExtent([2,14]).on("zoom",I=>{n(5,_=I.transform)}),et(i).call(g);const E=i.clientWidth,q=i.clientHeight,M=2,T=E/2-M*(E/1.8),N=q/2-M*(q/2.5),R=tt.translate(T,N).scale(M);et(i).call(g.transform,R),n(5,_=R)});const an={"herb. - flower":"#C2185B","herb. - fruit":"#AD1457","herb. - vegetative":"#880E4F",seed:"#D81B60","herb. - twig/buds":"#E91E63","fruit colln":"#F06292","herb. - seedling":"#EC407A",bark:"#B71C1C"};function sn(E){return an[E]||"rgb(255, 141, 1)"}function on(E){Gt[E?"unshift":"push"](()=>{i=E,n(0,i)})}return r.$$set=E=>{"data"in E&&n(9,t=E.data),"currentYear"in E&&n(10,l=E.currentYear),"selectedCuratorData"in E&&n(11,a=E.selectedCuratorData)},r.$$.update=()=>{if(r.$$.dirty&1537&&t&&i&&l!==void 0&&n(1,s=se()),r.$$.dirty&2050)if(a&&a.PlantDates){let E=[...a.PlantDates].sort((M,T)=>M.Date-T.Date),q=[];E.forEach(M=>{const T=String(M.PlantID).toLowerCase(),N=s.find(R=>R.plantIDs&&R.plantIDs.includes(T));N&&!q.includes(N)&&q.push(N)}),n(2,c=q)}else n(2,c=[])},[i,s,c,f,o,_,h,v,sn,t,l,a,on]}class On extends me{constructor(e){super(),ve(this,e,Fn,An,pe,{data:9,currentYear:10,selectedCuratorData:11})}}function It(r,e,n){const t=r.slice();return t[2]=e[n],t}function Yt(r,e,n){const t=r.slice();return t[5]=e[n],t[7]=n,t}function zt(r){let e,n,t=r[7]===0?"1 year":`${r[7]*10} years`,l;return{c(){e=D("circle"),n=D("text"),l=$(t),this.h()},l(a){e=w(a,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0}),k(e).forEach(m),n=w(a,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0,class:!0});var i=k(n);l=K(i,t),i.forEach(m),this.h()},h(){u(e,"r",At+r[7]*Le),u(e,"fill","none"),u(e,"stroke","#888"),u(e,"stroke-width","1"),u(n,"x",At+r[7]*Le+20),u(n,"y",r[7]*Le/2+5),u(n,"dy","0.35em"),u(n,"text-anchor","middle"),u(n,"fill","black"),u(n,"font-size","10"),u(n,"class","svelte-1kn6isz")},m(a,i){S(a,e,i),S(a,n,i),y(n,l)},p:de,d(a){a&&(m(e),m(n))}}}function Tt(r){let e,n,t,l,a=r[2]+"",i,s;return{c(){e=H("div"),n=H("div"),t=x(),l=H("span"),i=$(a),s=x(),this.h()},l(c){e=B(c,"DIV",{class:!0});var f=k(e);n=B(f,"DIV",{class:!0,style:!0}),k(n).forEach(m),t=J(f),l=B(f,"SPAN",{class:!0});var o=k(l);i=K(o,a),o.forEach(m),s=J(f),f.forEach(m),this.h()},h(){u(n,"class","color-box svelte-1kn6isz"),Je(n,"background-color",r[0][r[2]]||"rgb(255, 141, 1)"),u(l,"class","label svelte-1kn6isz"),u(e,"class","swatch-row svelte-1kn6isz")},m(c,f){S(c,e,f),y(e,n),y(e,t),y(e,l),y(l,i),y(e,s)},p(c,f){f&1&&Je(n,"background-color",c[0][c[2]]||"rgb(255, 141, 1)")},d(c){c&&m(e)}}}function qn(r){let e,n,t,l,a,i,s,c='<div class="color-box svelte-1kn6isz" style="background-color: rgb(255, 141, 1);"></div> <span class="label svelte-1kn6isz">Other / Undefined</span>',f=P(Array(Lt+1)),o=[];for(let d=0;d<f.length;d+=1)o[d]=zt(Yt(r,f,d));let _=P(r[1]),g=[];for(let d=0;d<_.length;d+=1)g[d]=Tt(It(r,_,d));return{c(){e=H("div"),n=D("svg"),t=D("g");for(let d=0;d<o.length;d+=1)o[d].c();l=x(),a=H("div");for(let d=0;d<g.length;d+=1)g[d].c();i=x(),s=H("div"),s.innerHTML=c,this.h()},l(d){e=B(d,"DIV",{class:!0});var p=k(e);n=w(p,"svg",{class:!0,preserveAspectRatio:!0,width:!0,height:!0});var h=k(n);t=w(h,"g",{transform:!0});var v=k(t);for(let C=0;C<o.length;C+=1)o[C].l(v);v.forEach(m),h.forEach(m),l=J(p),a=B(p,"DIV",{class:!0});var b=k(a);for(let C=0;C<g.length;C+=1)g[C].l(b);i=J(b),s=B(b,"DIV",{class:!0,"data-svelte-h":!0}),cn(s)!=="svelte-19qfir0"&&(s.innerHTML=c),b.forEach(m),p.forEach(m),this.h()},h(){u(t,"transform","translate(0,60)"),u(n,"class","infographic svelte-1kn6isz"),u(n,"preserveAspectRatio","xMidYMid meet"),u(n,"width","100%"),u(n,"height","150"),u(s,"class","swatch-row svelte-1kn6isz"),u(a,"class","color-swatch-section svelte-1kn6isz"),u(e,"class","legend-container svelte-1kn6isz")},m(d,p){S(d,e,p),y(e,n),y(n,t);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);y(e,l),y(e,a);for(let h=0;h<g.length;h+=1)g[h]&&g[h].m(a,null);y(a,i),y(a,s)},p(d,[p]){if(p&0){f=P(Array(Lt+1));let h;for(h=0;h<f.length;h+=1){const v=Yt(d,f,h);o[h]?o[h].p(v,p):(o[h]=zt(v),o[h].c(),o[h].m(t,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=f.length}if(p&3){_=P(d[1]);let h;for(h=0;h<_.length;h+=1){const v=It(d,_,h);g[h]?g[h].p(v,p):(g[h]=Tt(v),g[h].c(),g[h].m(a,i))}for(;h<g.length;h+=1)g[h].d(1);g.length=_.length}},i:de,o:de,d(d){d&&m(e),le(o,d),le(g,d)}}}const Lt=20,At=10,Le=20;function Vn(r,e,n){let{classColorMapping:t}=e;const l=Object.keys(t);return r.$$set=a=>{"classColorMapping"in a&&n(0,t=a.classColorMapping)},[t,l]}class Bn extends me{constructor(e){super(),ve(this,e,Vn,qn,pe,{classColorMapping:0})}}function Ft(r,e,n){const t=r.slice();return t[11]=e[n],t}function Ot(r,e,n){const t=r.slice();return t[14]=e[n],t}function qt(r){let e,n,t,l,a,i,s,c=r[11].PlantDates.length+"",f,o,_=r[11].PlantDates.length===1?"":"s",g,d=P(r[11].PlantDates),p=[];for(let h=0;h<d.length;h+=1)p[h]=Vt(Ot(r,d,h));return{c(){e=D("svg"),n=D("line");for(let h=0;h<p.length;h+=1)p[h].c();t=D("text"),l=$(r[0]),a=D("text"),i=$(r[1]),s=D("text"),f=$(c),o=$(" annotation"),g=$(_),this.h()},l(h){e=w(h,"svg",{class:!0,width:!0,height:!0});var v=k(e);n=w(v,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,class:!0}),k(n).forEach(m);for(let se=0;se<p.length;se+=1)p[se].l(v);t=w(v,"text",{x:!0,y:!0,"font-size":!0,fill:!0,class:!0});var b=k(t);l=K(b,r[0]),b.forEach(m),a=w(v,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var C=k(a);i=K(C,r[1]),C.forEach(m),s=w(v,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var te=k(s);f=K(te,c),o=K(te," annotation"),g=K(te,_),te.forEach(m),v.forEach(m),this.h()},h(){u(n,"x1","10"),u(n,"y1","12"),u(n,"x2","310"),u(n,"y2","12"),u(n,"stroke","#ccc"),u(n,"stroke-width","1"),u(n,"class","svelte-1l36wbu"),u(t,"x","10"),u(t,"y","8"),u(t,"font-size","8"),u(t,"fill","#333"),u(t,"class","svelte-1l36wbu"),u(a,"x","310"),u(a,"y","8"),u(a,"font-size","8"),u(a,"fill","#333"),u(a,"text-anchor","end"),u(a,"class","svelte-1l36wbu"),u(s,"x","160"),u(s,"y","23"),u(s,"font-size","8"),u(s,"fill","#333"),u(s,"text-anchor","middle"),u(s,"class","svelte-1l36wbu"),u(e,"class","histogram svelte-1l36wbu"),u(e,"width","320"),u(e,"height","25")},m(h,v){S(h,e,v),y(e,n);for(let b=0;b<p.length;b+=1)p[b]&&p[b].m(e,null);y(e,t),y(t,l),y(e,a),y(a,i),y(e,s),y(s,f),y(s,o),y(s,g)},p(h,v){if(v&36){d=P(h[11].PlantDates);let b;for(b=0;b<d.length;b+=1){const C=Ot(h,d,b);p[b]?p[b].p(C,v):(p[b]=Vt(C),p[b].c(),p[b].m(e,t))}for(;b<p.length;b+=1)p[b].d(1);p.length=d.length}v&1&&be(l,h[0]),v&2&&be(i,h[1]),v&4&&c!==(c=h[11].PlantDates.length+"")&&be(f,c),v&4&&_!==(_=h[11].PlantDates.length===1?"":"s")&&be(g,_)},d(h){h&&m(e),le(p,h)}}}function Vt(r){let e,n;return{c(){e=D("circle"),this.h()},l(t){e=w(t,"circle",{cx:!0,cy:!0,r:!0,class:!0}),k(e).forEach(m),this.h()},h(){u(e,"cx",n=r[5](r[14].Date)),u(e,"cy","12"),u(e,"r","2"),u(e,"class","svelte-1l36wbu")},m(t,l){S(t,e,l)},p(t,l){l&4&&n!==(n=t[5](t[14].Date))&&u(e,"cx",n)},d(t){t&&m(e)}}}function Bt(r,e){let n,t,l,a,i=e[11].PlantDates&&e[11].PlantDates.length>0&&qt(e);function s(){return e[9](e[11])}return{key:r,first:null,c(){n=H("li"),i&&i.c(),t=x(),this.h()},l(c){n=B(c,"LI",{class:!0});var f=k(n);i&&i.l(f),t=J(f),f.forEach(m),this.h()},h(){u(n,"class","svelte-1l36wbu"),xe(n,"selected",e[11].CuratorName===e[3]),this.first=n},m(c,f){S(c,n,f),i&&i.m(n,null),y(n,t),l||(a=fn(n,"click",s),l=!0)},p(c,f){e=c,e[11].PlantDates&&e[11].PlantDates.length>0?i?i.p(e,f):(i=qt(e),i.c(),i.m(n,t)):i&&(i.d(1),i=null),f&12&&xe(n,"selected",e[11].CuratorName===e[3])},d(c){c&&m(n),i&&i.d(),l=!1,a()}}}function Hn(r){let e,n,t,l,a=[],i=new Map,s;n=new Bn({props:{classColorMapping:r[6]}});let c=P(r[2]);const f=o=>o[11].CuratorName;for(let o=0;o<c.length;o+=1){let _=Ft(r,c,o),g=f(_);i.set(g,a[o]=Bt(g,_))}return{c(){e=H("aside"),Ie(n.$$.fragment),t=x(),l=H("ul");for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=B(o,"ASIDE",{class:!0});var _=k(e);Re(n.$$.fragment,_),t=J(_),l=B(_,"UL",{class:!0});var g=k(l);for(let d=0;d<a.length;d+=1)a[d].l(g);g.forEach(m),_.forEach(m),this.h()},h(){u(l,"class","svelte-1l36wbu"),u(e,"class","curator-sidebar svelte-1l36wbu")},m(o,_){S(o,e,_),Ne(n,e,null),y(e,t),y(e,l);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(l,null);s=!0},p(o,[_]){_&63&&(c=P(o[2]),a=Xt(a,_,f,1,o,c,i,l,jt,Bt,null,Ft))},i(o){s||(z(n.$$.fragment,o),s=!0)},o(o){G(n.$$.fragment,o),s=!1},d(o){o&&m(e),Pe(n);for(let _=0;_<a.length;_+=1)a[_].d()}}}function Un(r){return r&&r.length>0?Math.min(...r):1/0}function Wn(r,e,n){let t,l,{minYear:a}=e,{maxYear:i}=e,{curatorData:s=[]}=e,{initialCurator:c=""}=e;const f=un();function o(p){n(3,l=p);const h=s.find(v=>v.CuratorName.toLowerCase()===p.toLowerCase());f("curatorChange",{selectedCuratorData:h})}function _(p){return i===a?160:10+(p-a)/(i-a)*300}const g={"herb. - flower":"#C2185B","herb. - fruit":"#AD1457","herb. - vegetative":"#880E4F",seed:"#D81B60","herb. - twig/buds":"#E91E63","fruit colln":"#F06292","herb. - seedling":"#EC407A",bark:"#B71C1C"},d=p=>o(p.CuratorName);return r.$$set=p=>{"minYear"in p&&n(0,a=p.minYear),"maxYear"in p&&n(1,i=p.maxYear),"curatorData"in p&&n(7,s=p.curatorData),"initialCurator"in p&&n(8,c=p.initialCurator)},r.$$.update=()=>{r.$$.dirty&128&&n(2,t=s.map(p=>{var h;return{...p,minDate:Un((h=p.PlantDates)==null?void 0:h.map(v=>v.Date))}}).sort((p,h)=>p.minDate-h.minDate)),r.$$.dirty&260&&n(3,l=c||(t.length>0?t[0].CuratorName:""))},[a,i,t,l,o,_,g,s,c,d]}class Gn extends me{constructor(e){super(),ve(this,e,Wn,Hn,pe,{minYear:0,maxYear:1,curatorData:7,initialCurator:8})}}function Ht(r){let e,n,t,l,a=r[1].length>0&&Ut(r),i=r[3]&&r[4]&&Wt(r);return{c(){e=H("div"),n=H("div"),a&&a.c(),t=x(),i&&i.c(),this.h()},l(s){e=B(s,"DIV",{class:!0});var c=k(e);n=B(c,"DIV",{class:!0});var f=k(n);a&&a.l(f),f.forEach(m),t=J(c),i&&i.l(c),c.forEach(m),this.h()},h(){u(n,"class","main svelte-dgiw5l"),u(e,"class","container svelte-dgiw5l")},m(s,c){S(s,e,c),y(e,n),a&&a.m(n,null),y(e,t),i&&i.m(e,null),l=!0},p(s,c){s[1].length>0?a?(a.p(s,c),c&2&&z(a,1)):(a=Ut(s),a.c(),z(a,1),a.m(n,null)):a&&(Fe(),G(a,1,1,()=>{a=null}),Ae()),s[3]&&s[4]?i?(i.p(s,c),c&24&&z(i,1)):(i=Wt(s),i.c(),z(i,1),i.m(e,null)):i&&(Fe(),G(i,1,1,()=>{i=null}),Ae())},i(s){l||(z(a),z(i),l=!0)},o(s){G(a),G(i),l=!1},d(s){s&&m(e),a&&a.d(),i&&i.d()}}}function Ut(r){let e,n;return e=new On({props:{data:r[1],currentYear:r[2],selectedCuratorData:r[5]}}),{c(){Ie(e.$$.fragment)},l(t){Re(e.$$.fragment,t)},m(t,l){Ne(e,t,l),n=!0},p(t,l){const a={};l&2&&(a.data=t[1]),l&4&&(a.currentYear=t[2]),l&32&&(a.selectedCuratorData=t[5]),e.$set(a)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){Pe(e,t)}}}function Wt(r){let e,n;return e=new Gn({props:{curatorData:r[0],minYear:r[3],maxYear:r[4]}}),e.$on("curatorChange",r[6]),{c(){Ie(e.$$.fragment)},l(t){Re(e.$$.fragment,t)},m(t,l){Ne(e,t,l),n=!0},p(t,l){const a={};l&1&&(a.curatorData=t[0]),l&8&&(a.minYear=t[3]),l&16&&(a.maxYear=t[4]),e.$set(a)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){Pe(e,t)}}}function Xn(r){let e,n,t=r[1].length>0&&r[0].length>0&&Ht(r);return{c(){t&&t.c(),e=X()},l(l){t&&t.l(l),e=X()},m(l,a){t&&t.m(l,a),S(l,e,a),n=!0},p(l,[a]){l[1].length>0&&l[0].length>0?t?(t.p(l,a),a&3&&z(t,1)):(t=Ht(l),t.c(),z(t,1),t.m(e.parentNode,e)):t&&(Fe(),G(t,1,1,()=>{t=null}),Ae())},i(l){n||(z(t),n=!0)},o(l){G(t),n=!1},d(l){l&&m(e),t&&t.d(l)}}}function jn(r,e,n){let t=[],l=[],a=2011,i,s,c=null;Ze(async()=>{const o=await fetch("data/ArnArbPlantsinfo.json");n(1,t=await o.json()),n(3,i=Math.min(...t.map(g=>parseInt(g.ACC_YR)))),n(4,s=Math.max(...t.map(g=>parseInt(g.ACC_YR)))),n(2,a=s);const _=await fetch("data/Curator_Plants_Dates.json");n(0,l=await _.json()),l.length>0&&n(5,c=l[0])});function f(o){n(5,c=o.detail.selectedCuratorData)}return r.$$.update=()=>{r.$$.dirty&1&&console.log(l)},[l,t,a,i,s,c,f]}class $n extends me{constructor(e){super(),ve(this,e,jn,Xn,pe,{})}}export{$n as component};
