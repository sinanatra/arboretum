import{s as st,n as V,d,i as k,p as N,r as Ot,O as v,h as m,P as b,z as Ae,x as c,Q as qt,e as y,y as Ht,R as Ct,f as Z,l as j,j as A,t as T,S as nn,b as et,T as Ut,U as rn,k as dt,m as _t}from"../chunks/CCjlHDLj.js";import{S as ct,i as ut,d as gt,t as q,a as x,m as mt,e as pt,b as yt,c as Te,g as Fe}from"../chunks/BDgAEpGB.js";import{e as M,u as xt,d as Gt,z as ln,s as Zt,i as jt,m as Bt,a as Qt,l as Jt}from"../chunks/CTTnlaC5.js";class J{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let l=0;l<this._n&&l<32;l++){const a=n[l],i=t+a,o=Math.abs(t)<Math.abs(a)?t-(i-a):a-(i-t);o&&(n[e++]=o),t=i}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n=this._n,e,l,a,i=0;if(n>0){for(i=t[--n];n>0&&(e=i,l=t[--n],i=e+l,a=l-(i-e),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(l=a*2,e=i+l,l==e-i&&(i=e))}return i}}var an=Math.PI,on=an*2,sn=Math.abs,Wt=Math.sqrt;function $(){}function kt(r,t){r&&te.hasOwnProperty(r.type)&&te[r.type](r,t)}var Kt={Feature:function(r,t){kt(r.geometry,t)},FeatureCollection:function(r,t){for(var n=r.features,e=-1,l=n.length;++e<l;)kt(n[e].geometry,t)}},te={Sphere:function(r,t){t.sphere()},Point:function(r,t){r=r.coordinates,t.point(r[0],r[1],r[2])},MultiPoint:function(r,t){for(var n=r.coordinates,e=-1,l=n.length;++e<l;)r=n[e],t.point(r[0],r[1],r[2])},LineString:function(r,t){Pt(r.coordinates,t,0)},MultiLineString:function(r,t){for(var n=r.coordinates,e=-1,l=n.length;++e<l;)Pt(n[e],t,0)},Polygon:function(r,t){ee(r.coordinates,t)},MultiPolygon:function(r,t){for(var n=r.coordinates,e=-1,l=n.length;++e<l;)ee(n[e],t)},GeometryCollection:function(r,t){for(var n=r.geometries,e=-1,l=n.length;++e<l;)kt(n[e],t)}};function Pt(r,t,n){var e=-1,l=r.length-n,a;for(t.lineStart();++e<l;)a=r[e],t.point(a[0],a[1],a[2]);t.lineEnd()}function ee(r,t){var n=-1,e=r.length;for(t.polygonStart();++n<e;)Pt(r[n],t,1);t.polygonEnd()}function tt(r,t){r&&Kt.hasOwnProperty(r.type)?Kt[r.type](r,t):kt(r,t)}const cn=r=>r;var Dt=new J,Rt=new J,Oe,xe,zt,Lt,W={point:$,lineStart:$,lineEnd:$,polygonStart:function(){W.lineStart=un,W.lineEnd=hn},polygonEnd:function(){W.lineStart=W.lineEnd=W.point=$,Dt.add(sn(Rt)),Rt=new J},result:function(){var r=Dt/2;return Dt=new J,r}};function un(){W.point=fn}function fn(r,t){W.point=Ge,Oe=zt=r,xe=Lt=t}function Ge(r,t){Rt.add(Lt*r-zt*t),zt=r,Lt=t}function hn(){Ge(Oe,xe)}var K=1/0,vt=K,at=-K,bt=at,ne={point:dn,lineStart:$,lineEnd:$,polygonStart:$,polygonEnd:$,result:function(){var r=[[K,vt],[at,bt]];return at=bt=-(vt=K=1/0),r}};function dn(r,t){r<K&&(K=r),r>at&&(at=r),t<vt&&(vt=t),t>bt&&(bt=t)}var It=0,$t=0,nt=0,St=0,Et=0,Q=0,Yt=0,At=0,rt=0,We,Ve,F,O,z={point:B,lineStart:re,lineEnd:le,polygonStart:function(){z.lineStart=mn,z.lineEnd=pn},polygonEnd:function(){z.point=B,z.lineStart=re,z.lineEnd=le},result:function(){var r=rt?[Yt/rt,At/rt]:Q?[St/Q,Et/Q]:nt?[It/nt,$t/nt]:[NaN,NaN];return It=$t=nt=St=Et=Q=Yt=At=rt=0,r}};function B(r,t){It+=r,$t+=t,++nt}function re(){z.point=_n}function _n(r,t){z.point=gn,B(F=r,O=t)}function gn(r,t){var n=r-F,e=t-O,l=Wt(n*n+e*e);St+=l*(F+r)/2,Et+=l*(O+t)/2,Q+=l,B(F=r,O=t)}function le(){z.point=B}function mn(){z.point=yn}function pn(){Xe(We,Ve)}function yn(r,t){z.point=Xe,B(We=F=r,Ve=O=t)}function Xe(r,t){var n=r-F,e=t-O,l=Wt(n*n+e*e);St+=l*(F+r)/2,Et+=l*(O+t)/2,Q+=l,l=O*r-F*t,Yt+=l*(F+r),At+=l*(O+t),rt+=l*3,B(F=r,O=t)}function qe(r){this._context=r}qe.prototype={_radius:4.5,pointRadius:function(r){return this._radius=r,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(r,t){switch(this._point){case 0:{this._context.moveTo(r,t),this._point=1;break}case 1:{this._context.lineTo(r,t);break}default:{this._context.moveTo(r+this._radius,t),this._context.arc(r,t,this._radius,0,on);break}}},result:$};var Tt=new J,Nt,He,Ue,lt,it,ot={point:$,lineStart:function(){ot.point=kn},lineEnd:function(){Nt&&Ze(He,Ue),ot.point=$},polygonStart:function(){Nt=!0},polygonEnd:function(){Nt=null},result:function(){var r=+Tt;return Tt=new J,r}};function kn(r,t){ot.point=Ze,He=lt=r,Ue=it=t}function Ze(r,t){lt-=r,it-=t,Tt.add(Wt(lt*lt+it*it)),lt=r,it=t}let ie,wt,ae,oe;class se{constructor(t){this._append=t==null?je:vn(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==ae||this._append!==wt){const e=this._radius,l=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,ae=e,wt=this._append,oe=this._,this._=l}this._+=oe;break}}}result(){const t=this._;return this._="",t.length?t:null}}function je(r){let t=1;this._+=r[0];for(const n=r.length;t<n;++t)this._+=arguments[t]+r[t]}function vn(r){const t=Math.floor(r);if(!(t>=0))throw new RangeError(`invalid digits: ${r}`);if(t>15)return je;if(t!==ie){const n=10**t;ie=t,wt=function(l){let a=1;this._+=l[0];for(const i=l.length;a<i;++a)this._+=Math.round(arguments[a]*n)/n+l[a]}}return wt}function bn(r,t){let n=3,e=4.5,l,a;function i(o){return o&&(typeof e=="function"&&a.pointRadius(+e.apply(this,arguments)),tt(o,l(a))),a.result()}return i.area=function(o){return tt(o,l(W)),W.result()},i.measure=function(o){return tt(o,l(ot)),ot.result()},i.bounds=function(o){return tt(o,l(ne)),ne.result()},i.centroid=function(o){return tt(o,l(z)),z.result()},i.projection=function(o){return arguments.length?(l=o==null?(r=null,cn):(r=o).stream,i):r},i.context=function(o){return arguments.length?(a=o==null?(t=null,new se(n)):new qe(t=o),typeof e!="function"&&a.pointRadius(e),i):t},i.pointRadius=function(o){return arguments.length?(e=typeof o=="function"?o:(a.pointRadius(+o),+o),i):e},i.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const s=Math.floor(o);if(!(s>=0))throw new RangeError(`invalid digits: ${o}`);n=s}return t===null&&(a=new se(n)),i},i.projection(r).digits(n).context(t)}function Sn(r){return{stream:En(r)}}function En(r){return function(t){var n=new Ft;for(var e in r)n[e]=r[e];return n.stream=t,n}}function Ft(){}Ft.prototype={constructor:Ft,point:function(r,t){this.stream.point(r,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ce(r,t,n){const e=r.slice();return e[7]=t[n],e[9]=n,e}function ue(r){let t,n=[],e=new Map,l=M(r[0].features);const a=i=>i[7].id||i[9];for(let i=0;i<l.length;i+=1){let o=ce(r,l,i),s=a(o);e.set(s,n[i]=fe(s,o))}return{c(){t=b("g");for(let i=0;i<n.length;i+=1)n[i].c()},l(i){t=v(i,"g",{});var o=m(t);for(let s=0;s<n.length;s+=1)n[s].l(o);o.forEach(d)},m(i,o){k(i,t,o);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(t,null);r[6](t)},p(i,o){o&3&&(l=M(i[0].features),n=xt(n,o,a,1,i,l,e,t,Gt,fe,null,ce))},d(i){i&&d(t);for(let o=0;o<n.length;o+=1)n[o].d();r[6](null)}}}function fe(r,t){let n,e,l;return{key:r,first:null,c(){n=b("path"),this.h()},l(a){n=v(a,"path",{d:!0,class:!0}),m(n).forEach(d),this.h()},h(){c(n,"d",e=t[1](t[7])),c(n,"class",l=qt("pixel "+t[7].properties.type)+" svelte-9pknnq"),this.first=n},m(a,i){k(a,n,i)},p(a,i){t=a,i&3&&e!==(e=t[1](t[7]))&&c(n,"d",e),i&1&&l!==(l=qt("pixel "+t[7].properties.type)+" svelte-9pknnq")&&c(n,"class",l)},d(a){a&&d(n)}}}function wn(r){let t,n=r[0]&&r[1]&&ue(r);return{c(){n&&n.c(),t=N()},l(e){n&&n.l(e),t=N()},m(e,l){n&&n.m(e,l),k(e,t,l)},p(e,[l]){e[0]&&e[1]?n?n.p(e,l):(n=ue(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:V,o:V,d(e){e&&d(t),n&&n.d(e)}}}function Cn(r,t,n){let{xScale:e}=t,{yScale:l}=t,{transform:a={x:0,y:0,k:1}}=t,i=null,o=null,s;Ot(async()=>{try{const f=await fetch("/pixelated.geojson");n(0,i=await f.json()),console.log("Loaded pixelated geojson:",i.features.length,"features");const g=Sn({point(h,_){this.stream.point(e(h),l(_))}});n(1,o=bn().projection(g))}catch(f){console.error("Error loading pixelated.geojson",f)}});function u(f){Ae[f?"unshift":"push"](()=>{s=f,n(2,s)})}return r.$$set=f=>{"xScale"in f&&n(3,e=f.xScale),"yScale"in f&&n(4,l=f.yScale),"transform"in f&&n(5,a=f.transform)},[i,o,s,e,l,a,u]}class Dn extends ct{constructor(t){super(),ut(this,t,Cn,wn,st,{xScale:3,yScale:4,transform:5})}}function he(r,t,n){const e=r.slice();return e[19]=t[n],e[21]=n,e}function de(r,t,n){const e=r.slice();return e[19]=t[n],e}function _e(r,t,n){const e=r.slice();return e[24]=t[n],e[21]=n,e}function Nn(r){let t,n;return{c(){t=b("circle"),this.h()},l(e){t=v(e,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0}),m(t).forEach(d),this.h()},h(){c(t,"r",r[6]),c(t,"fill","none"),c(t,"stroke",n=r[19].color),c(t,"stroke-width","0.1"),c(t,"class","svelte-1aszhlb")},m(e,l){k(e,t,l)},p(e,l){l&2&&n!==(n=e[19].color)&&c(t,"stroke",n)},d(e){e&&d(t)}}}function Mn(r){let t,n=M(Array(r[19].numRings)),e=[];for(let l=0;l<n.length;l+=1)e[l]=ge(_e(r,n,l));return{c(){for(let l=0;l<e.length;l+=1)e[l].c();t=N()},l(l){for(let a=0;a<e.length;a+=1)e[a].l(l);t=N()},m(l,a){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(l,a);k(l,t,a)},p(l,a){if(a&194){n=M(Array(l[19].numRings));let i;for(i=0;i<n.length;i+=1){const o=_e(l,n,i);e[i]?e[i].p(o,a):(e[i]=ge(o),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=n.length}},d(l){l&&d(t),Ct(e,l)}}}function ge(r){let t,n;return{c(){t=b("circle"),this.h()},l(e){t=v(e,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0}),m(t).forEach(d),this.h()},h(){c(t,"r",r[6]+r[21]*r[7]),c(t,"fill","none"),c(t,"stroke",n=r[19].color),c(t,"stroke-width","0.1"),c(t,"class","svelte-1aszhlb")},m(e,l){k(e,t,l)},p(e,l){l&2&&n!==(n=e[19].color)&&c(t,"stroke",n)},d(e){e&&d(t)}}}function me(r,t){let n,e;function l(o,s){return o[19].numRings>0?Mn:Nn}let a=l(t),i=a(t);return{key:r,first:null,c(){n=b("g"),i.c(),this.h()},l(o){n=v(o,"g",{class:!0,transform:!0});var s=m(n);i.l(s),s.forEach(d),this.h()},h(){c(n,"class","node svelte-1aszhlb"),c(n,"transform",e="translate("+t[19].x+", "+t[19].y+")"),this.first=n},m(o,s){k(o,n,s),i.m(n,null)},p(o,s){t=o,a===(a=l(t))&&i?i.p(t,s):(i.d(1),i=a(t),i&&(i.c(),i.m(n,null))),s&2&&e!==(e="translate("+t[19].x+", "+t[19].y+")")&&c(n,"transform",e)},d(o){o&&d(n),i.d()}}}function pe(r){let t,n,e,l,a=M(r[2].slice(0,r[2].length-1)),i=[];for(let o=0;o<a.length;o+=1)i[o]=ke(he(r,a,o));return{c(){t=b("g"),n=b("defs"),e=b("marker"),l=b("polygon");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){t=v(o,"g",{class:!0});var s=m(t);n=v(s,"defs",{});var u=m(n);e=v(u,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var f=m(e);l=v(f,"polygon",{points:!0,fill:!0}),m(l).forEach(d),f.forEach(d),u.forEach(d);for(let g=0;g<i.length;g+=1)i[g].l(s);s.forEach(d),this.h()},h(){c(l,"points","0 0, 6 2, 0 4"),c(l,"fill","blue"),c(e,"id","arrowhead"),c(e,"markerWidth","6"),c(e,"markerHeight","4"),c(e,"refX","3"),c(e,"refY","2"),c(e,"orient","auto"),c(t,"class","curator-path svelte-1aszhlb")},m(o,s){k(o,t,s),y(t,n),y(n,e),y(e,l);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(t,null)},p(o,s){if(s&4){a=M(o[2].slice(0,o[2].length-1));let u;for(u=0;u<a.length;u+=1){const f=he(o,a,u);i[u]?i[u].p(f,s):(i[u]=ke(f),i[u].c(),i[u].m(t,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=a.length}},d(o){o&&d(t),Ct(i,o)}}}function ye(r){let t,n;return{c(){t=b("path"),this.h()},l(e){t=v(e,"path",{d:!0,fill:!0,stroke:!0,"stroke-width":!0,"marker-end":!0,class:!0}),m(t).forEach(d),this.h()},h(){c(t,"d",n=we(r[19],r[2][r[21]+1])),c(t,"fill","none"),c(t,"stroke","blue"),c(t,"stroke-width",".5"),c(t,"marker-end","url(#arrowhead)"),c(t,"class","svelte-1aszhlb")},m(e,l){k(e,t,l)},p(e,l){l&4&&n!==(n=we(e[19],e[2][e[21]+1]))&&c(t,"d",n)},d(e){e&&d(t)}}}function ke(r){let t,n=r[2][r[21]+1]&&ye(r);return{c(){n&&n.c(),t=N()},l(e){n&&n.l(e),t=N()},m(e,l){n&&n.m(e,l),k(e,t,l)},p(e,l){e[2][e[21]+1]?n?n.p(e,l):(n=ye(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){e&&d(t),n&&n.d(e)}}}function Pn(r){let t,n,e,l=[],a=new Map,i,o,s;e=new Dn({props:{transform:r[5],xScale:r[3],yScale:r[4]}});let u=M(r[1]);const f=h=>h[19].id;for(let h=0;h<u.length;h+=1){let _=de(r,u,h),p=f(_);a.set(p,l[h]=me(p,_))}let g=r[2].length>1&&pe(r);return{c(){t=b("svg"),n=b("g"),yt(e.$$.fragment);for(let h=0;h<l.length;h+=1)l[h].c();i=N(),g&&g.c(),this.h()},l(h){t=v(h,"svg",{style:!0,class:!0});var _=m(t);n=v(_,"g",{transform:!0});var p=m(n);pt(e.$$.fragment,p);for(let Y=0;Y<l.length;Y+=1)l[Y].l(p);i=N(),g&&g.l(p),p.forEach(d),_.forEach(d),this.h()},h(){c(n,"transform",o="translate("+r[5].x+", "+r[5].y+") scale("+r[5].k+")"),Ht(t,"width","100%"),Ht(t,"height","100vh"),c(t,"class","svelte-1aszhlb")},m(h,_){k(h,t,_),y(t,n),mt(e,n,null);for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(n,null);y(n,i),g&&g.m(n,null),r[11](t),s=!0},p(h,[_]){const p={};_&32&&(p.transform=h[5]),_&8&&(p.xScale=h[3]),_&16&&(p.yScale=h[4]),e.$set(p),_&194&&(u=M(h[1]),l=xt(l,_,f,1,h,u,a,n,Gt,me,i,de)),h[2].length>1?g?g.p(h,_):(g=pe(h),g.c(),g.m(n,null)):g&&(g.d(1),g=null),(!s||_&32&&o!==(o="translate("+h[5].x+", "+h[5].y+") scale("+h[5].k+")"))&&c(n,"transform",o)},i(h){s||(x(e.$$.fragment,h),s=!0)},o(h){q(e.$$.fragment,h),s=!1},d(h){h&&d(t),gt(e);for(let _=0;_<l.length;_+=1)l[_].d();g&&g.d(),r[11](null)}}}const ve=1,be=1,Se=10,Ee=5;function Rn(r){return"DarkSeaGreen"}function we(r,t,n=20){const e=t.x-r.x,l=t.y-r.y,a=(r.x+t.x)/2,i=(r.y+t.y)/2,o=Math.sqrt(e*e+l*l)||1,s=-l/o,u=e/o,f=a+s*n,g=i+u*n;return`M ${r.x} ${r.y} Q ${f} ${g} ${t.x} ${t.y}`}function zn(r,t,n){let e,{data:l=[]}=t,{currentYear:a}=t,{selectedCuratorData:i=null}=t,o,s=[],u,f,g=jt,h;const _=ve+(Se-1)*be,p=Ee/2/_,Y=ve*p,H=be*p,P=_*p,S=Ee;function w(){o.clientWidth,o.clientHeight;const E=l.map(I=>parseFloat(I.LONGITUDE)).filter(I=>!isNaN(I)),D=l.map(I=>parseFloat(I.LATITUDE)).filter(I=>!isNaN(I));let C=Bt(E),R=Qt(E),X=Bt(D),L=Qt(D);const U=(R-C)*.2,G=(L-X)*.2;C-=U,R+=U,X-=G,L+=G,n(3,u=Jt().domain([C,R]).range([0,o.clientWidth])),n(4,f=Jt().domain([X,L]).range([o.clientHeight,0]))}function ft(){return!l||!o||a===void 0?[]:(w(),l.map((D,C)=>{const R=parseFloat(D.LONGITUDE),X=parseFloat(D.LATITUDE),L=parseInt(D.ACC_YR),U=parseInt(D.last_date);if(isNaN(R)||isNaN(X)||isNaN(L)||isNaN(U))return null;let G=0;a>=L&&(G=Math.floor((a-L)/10),G=Math.min(G,Se));let I=G>0?Y+(G-1)*H:Y;I=Math.min(I,P);const Be=u(R),Qe=f(X),Je=Math.floor(Be/S),Ke=Math.floor(Qe/S),tn=Je*S+S/2,en=Ke*S+S/2;return{id:D.PLANTID?D.PLANTID:C,x:tn,y:en,accYear:L,lastDate:U,numRings:G,outerRadius:I,color:Rn()}}).filter(Boolean))}Ot(()=>{h=ln().scaleExtent([2,14]).on("zoom",U=>{n(5,g=U.transform)}),Zt(o).call(h);const E=o.clientWidth,D=o.clientHeight,C=2,R=E/2-C*(E/1.8),X=D/2-C*(D/2.5),L=jt.translate(R,X).scale(C);Zt(o).call(h.transform,L),n(5,g=L)});function ht(E){Ae[E?"unshift":"push"](()=>{o=E,n(0,o)})}return r.$$set=E=>{"data"in E&&n(8,l=E.data),"currentYear"in E&&n(9,a=E.currentYear),"selectedCuratorData"in E&&n(10,i=E.selectedCuratorData)},r.$$.update=()=>{if(r.$$.dirty&769&&l&&o&&a!==void 0&&n(1,s=ft()),r.$$.dirty&1030&&i&&i.PlantDates){const D=[...i.PlantDates].sort((C,R)=>C.Date-R.Date).map(C=>String(C.PlantID).toLowerCase());n(2,e=s.filter(C=>D.includes(String(C.id).toLowerCase()))),e.sort((C,R)=>D.indexOf(String(C.id).toLowerCase())-D.indexOf(String(R.id).toLowerCase()))}},n(2,e=[]),[o,s,e,u,f,g,Y,H,l,a,i,ht]}class Ln extends ct{constructor(t){super(),ut(this,t,zn,Pn,st,{data:8,currentYear:9,selectedCuratorData:10})}}function Ce(r,t,n){const e=r.slice();return e[2]=t[n],e[4]=n,e}function In(r){let t,n="1",e,l;return{c(){t=b("text"),e=T(n),l=T(` year
          `),this.h()},l(a){t=v(a,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0});var i=m(t);e=A(i,n),l=A(i,` year
          `),i.forEach(d),this.h()},h(){c(t,"x","25"),c(t,"y",-(Vt+r[4]*Xt)),c(t,"dy","1.2em"),c(t,"text-anchor","middle"),c(t,"fill","black"),c(t,"font-size","10")},m(a,i){k(a,t,i),y(t,e),y(t,l)},p:V,d(a){a&&d(t)}}}function $n(r){let t,n=r[4]*10+"",e,l;return{c(){t=b("text"),e=T(n),l=T(` years
          `),this.h()},l(a){t=v(a,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0});var i=m(t);e=A(i,n),l=A(i,` years
          `),i.forEach(d),this.h()},h(){c(t,"x","25"),c(t,"y",-(Vt+r[4]*Xt)),c(t,"dy","1.2em"),c(t,"text-anchor","middle"),c(t,"fill","black"),c(t,"font-size","10")},m(a,i){k(a,t,i),y(t,e),y(t,l)},p:V,d(a){a&&d(t)}}}function De(r){let t,n;function e(i,o){return i[4]>0?$n:In}let a=e(r)(r);return{c(){t=b("circle"),a.c(),n=N(),this.h()},l(i){t=v(i,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0}),m(t).forEach(d),a.l(i),n=N(),this.h()},h(){c(t,"r",Vt+r[4]*Xt),c(t,"fill","none"),c(t,"stroke","#888"),c(t,"stroke-width","1")},m(i,o){k(i,t,o),a.m(i,o),k(i,n,o)},p(i,o){a.p(i,o)},d(i){i&&(d(t),d(n)),a.d(i)}}}function Yn(r){let t,n,e,l=M(Array(Ne+1)),a=[];for(let i=0;i<l.length;i+=1)a[i]=De(Ce(r,l,i));return{c(){t=j("div"),n=b("svg"),e=b("g");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){t=Z(i,"DIV",{class:!0});var o=m(t);n=v(o,"svg",{class:!0,width:!0,height:!0});var s=m(n);e=v(s,"g",{transform:!0});var u=m(e);for(let f=0;f<a.length;f+=1)a[f].l(u);u.forEach(d),s.forEach(d),o.forEach(d),this.h()},h(){c(e,"transform","translate(75, 60)"),c(n,"class","infographic"),c(n,"width","150"),c(n,"height","120"),c(t,"class","legend-container svelte-lugs7g")},m(i,o){k(i,t,o),y(t,n),y(n,e);for(let s=0;s<a.length;s+=1)a[s]&&a[s].m(e,null)},p(i,[o]){if(o&0){l=M(Array(Ne+1));let s;for(s=0;s<l.length;s+=1){const u=Ce(i,l,s);a[s]?a[s].p(u,o):(a[s]=De(u),a[s].c(),a[s].m(e,null))}for(;s<a.length;s+=1)a[s].d(1);a.length=l.length}},i:V,o:V,d(i){i&&d(t),Ct(a,i)}}}const Ne=4,Vt=10,Xt=20;function An(r,t,n){let{classColorMapping:e}=t;return r.$$set=l=>{"classColorMapping"in l&&n(0,e=l.classColorMapping)},[e]}class Tn extends ct{constructor(t){super(),ut(this,t,An,Yn,st,{classColorMapping:0})}}function Me(r,t,n){const e=r.slice();return e[7]=t[n],e}function Pe(r,t,n){const e=r.slice();return e[11]=t[n],e}function Mt(r){const t=r.slice(),n=Gn(t[7]);return t[10]=n,t}function Re(r){let t,n,e,l=r[10].minDate+"",a,i,o=r[10].maxDate+"",s,u,f=r[10].count+"",g,h,_=r[10].count===1?"":"s",p;function Y(S,w){return S[10].maxDate!==S[10].minDate?On:Fn}let H=Y(r),P=H(r);return{c(){t=b("svg"),n=b("line"),P.c(),e=b("text"),a=T(l),i=b("text"),s=T(o),u=b("text"),g=T(f),h=T(" annotation"),p=T(_),this.h()},l(S){t=v(S,"svg",{class:!0,width:!0,height:!0});var w=m(t);n=v(w,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,class:!0}),m(n).forEach(d),P.l(w),e=v(w,"text",{x:!0,y:!0,"font-size":!0,fill:!0,class:!0});var ft=m(e);a=A(ft,l),ft.forEach(d),i=v(w,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var ht=m(i);s=A(ht,o),ht.forEach(d),u=v(w,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var E=m(u);g=A(E,f),h=A(E," annotation"),p=A(E,_),E.forEach(d),w.forEach(d),this.h()},h(){c(n,"x1","10"),c(n,"y1","20"),c(n,"x2","280"),c(n,"y2","20"),c(n,"stroke","#ccc"),c(n,"stroke-width","2"),c(n,"class","svelte-14kd2y1"),c(e,"x","10"),c(e,"y","15"),c(e,"font-size","10"),c(e,"fill","#333"),c(e,"class","svelte-14kd2y1"),c(i,"x","280"),c(i,"y","15"),c(i,"font-size","10"),c(i,"fill","#333"),c(i,"text-anchor","end"),c(i,"class","svelte-14kd2y1"),c(u,"x","100"),c(u,"y","35"),c(u,"font-size","10"),c(u,"fill","#333"),c(u,"text-anchor","middle"),c(u,"class","svelte-14kd2y1"),c(t,"class","histogram svelte-14kd2y1"),c(t,"width","320"),c(t,"height","40")},m(S,w){k(S,t,w),y(t,n),P.m(t,null),y(t,e),y(e,a),y(t,i),y(i,s),y(t,u),y(u,g),y(u,h),y(u,p)},p(S,w){H===(H=Y(S))&&P?P.p(S,w):(P.d(1),P=H(S),P&&(P.c(),P.m(t,e))),w&1&&l!==(l=S[10].minDate+"")&&et(a,l),w&1&&o!==(o=S[10].maxDate+"")&&et(s,o),w&1&&f!==(f=S[10].count+"")&&et(g,f),w&1&&_!==(_=S[10].count===1?"":"s")&&et(p,_)},d(S){S&&d(t),P.d()}}}function Fn(r){let t;return{c(){t=b("circle"),this.h()},l(n){t=v(n,"circle",{cx:!0,cy:!0,r:!0,fill:!0,class:!0}),m(t).forEach(d),this.h()},h(){c(t,"cx","100"),c(t,"cy","20"),c(t,"r","4"),c(t,"fill","blue"),c(t,"class","svelte-14kd2y1")},m(n,e){k(n,t,e)},p:V,d(n){n&&d(t)}}}function On(r){let t,n=M(r[10].dates),e=[];for(let l=0;l<n.length;l+=1)e[l]=ze(Pe(r,n,l));return{c(){for(let l=0;l<e.length;l+=1)e[l].c();t=N()},l(l){for(let a=0;a<e.length;a+=1)e[a].l(l);t=N()},m(l,a){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(l,a);k(l,t,a)},p(l,a){if(a&1){n=M(l[10].dates);let i;for(i=0;i<n.length;i+=1){const o=Pe(l,n,i);e[i]?e[i].p(o,a):(e[i]=ze(o),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=n.length}},d(l){l&&d(t),Ct(e,l)}}}function ze(r){let t,n;return{c(){t=b("circle"),this.h()},l(e){t=v(e,"circle",{cx:!0,cy:!0,r:!0,fill:!0,class:!0}),m(t).forEach(d),this.h()},h(){c(t,"cx",n=Ie(r[11],r[10].minDate,r[10].maxDate)),c(t,"cy","20"),c(t,"r","2"),c(t,"fill","blue"),c(t,"class","svelte-14kd2y1")},m(e,l){k(e,t,l)},p(e,l){l&1&&n!==(n=Ie(e[11],e[10].minDate,e[10].maxDate))&&c(t,"cx",n)},d(e){e&&d(t)}}}function Le(r,t){let n,e,l=t[7].CuratorName+"",a,i,o,s,u,f=t[7].PlantDates&&t[7].PlantDates.length>0&&Re(Mt(t));function g(){return t[5](t[7])}return{key:r,first:null,c(){n=j("li"),e=j("div"),a=T(l),i=_t(),f&&f.c(),o=_t(),this.h()},l(h){n=Z(h,"LI",{class:!0});var _=m(n);e=Z(_,"DIV",{class:!0});var p=m(e);a=A(p,l),p.forEach(d),i=dt(_),f&&f.l(_),o=dt(_),_.forEach(d),this.h()},h(){c(e,"class","curator-name svelte-14kd2y1"),c(n,"class","svelte-14kd2y1"),Ut(n,"selected",t[7].CuratorName===t[1]),this.first=n},m(h,_){k(h,n,_),y(n,e),y(e,a),y(n,i),f&&f.m(n,null),y(n,o),s||(u=rn(n,"click",g),s=!0)},p(h,_){t=h,_&1&&l!==(l=t[7].CuratorName+"")&&et(a,l),t[7].PlantDates&&t[7].PlantDates.length>0?f?f.p(Mt(t),_):(f=Re(Mt(t)),f.c(),f.m(n,o)):f&&(f.d(1),f=null),_&3&&Ut(n,"selected",t[7].CuratorName===t[1])},d(h){h&&d(n),f&&f.d(),s=!1,u()}}}function xn(r){let t,n,e=[],l=new Map,a=M(r[0]);const i=o=>o[7].CuratorName;for(let o=0;o<a.length;o+=1){let s=Me(r,a,o),u=i(s);l.set(u,e[o]=Le(u,s))}return{c(){t=j("aside"),n=j("ul");for(let o=0;o<e.length;o+=1)e[o].c();this.h()},l(o){t=Z(o,"ASIDE",{class:!0});var s=m(t);n=Z(s,"UL",{class:!0});var u=m(n);for(let f=0;f<e.length;f+=1)e[f].l(u);u.forEach(d),s.forEach(d),this.h()},h(){c(n,"class","svelte-14kd2y1"),c(t,"class","curator-sidebar svelte-14kd2y1")},m(o,s){k(o,t,s),y(t,n);for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(n,null)},p(o,[s]){s&7&&(a=M(o[0]),e=xt(e,s,i,1,o,a,l,n,Gt,Le,null,Me))},i:V,o:V,d(o){o&&d(t);for(let s=0;s<e.length;s+=1)e[s].d()}}}function Gn(r){const t=r.PlantDates.map(l=>l.Date),n=Math.min(...t),e=Math.max(...t);return{minDate:n,maxDate:e,count:t.length,dates:t}}function Ie(r,t,n){return n===t?100:10+(r-t)/(n-t)*180}function Wn(r,t,n){let e,l,{curatorData:a=[]}=t,{initialCurator:i=""}=t;const o=nn();function s(f){n(1,l=f);const g=a.find(h=>h.CuratorName.toLowerCase()===f.toLowerCase());o("curatorChange",{selectedCuratorData:g})}const u=f=>s(f.CuratorName);return r.$$set=f=>{"curatorData"in f&&n(3,a=f.curatorData),"initialCurator"in f&&n(4,i=f.initialCurator)},r.$$.update=()=>{r.$$.dirty&8&&n(0,e=a.slice().sort((f,g)=>f.CuratorName.localeCompare(g.CuratorName))),r.$$.dirty&17&&n(1,l=i||(e.length>0?e[0]:""))},[e,l,s,a,i,u]}class Vn extends ct{constructor(t){super(),ut(this,t,Wn,xn,st,{curatorData:3,initialCurator:4})}}function $e(r){let t,n,e,l,a,i=r[1].length>0&&Ye(r);return l=new Vn({props:{curatorData:r[0]}}),l.$on("curatorChange",r[4]),{c(){t=j("div"),n=j("div"),i&&i.c(),e=_t(),yt(l.$$.fragment),this.h()},l(o){t=Z(o,"DIV",{class:!0});var s=m(t);n=Z(s,"DIV",{class:!0});var u=m(n);i&&i.l(u),u.forEach(d),e=dt(s),pt(l.$$.fragment,s),s.forEach(d),this.h()},h(){c(n,"class","main svelte-dgiw5l"),c(t,"class","container svelte-dgiw5l")},m(o,s){k(o,t,s),y(t,n),i&&i.m(n,null),y(t,e),mt(l,t,null),a=!0},p(o,s){o[1].length>0?i?(i.p(o,s),s&2&&x(i,1)):(i=Ye(o),i.c(),x(i,1),i.m(n,null)):i&&(Fe(),q(i,1,1,()=>{i=null}),Te());const u={};s&1&&(u.curatorData=o[0]),l.$set(u)},i(o){a||(x(i),x(l.$$.fragment,o),a=!0)},o(o){q(i),q(l.$$.fragment,o),a=!1},d(o){o&&d(t),i&&i.d(),gt(l)}}}function Ye(r){let t,n,e,l;return t=new Ln({props:{data:r[1],currentYear:r[2],selectedCuratorData:r[3]}}),e=new Tn({props:{classColorMapping:r[5]}}),{c(){yt(t.$$.fragment),n=_t(),yt(e.$$.fragment)},l(a){pt(t.$$.fragment,a),n=dt(a),pt(e.$$.fragment,a)},m(a,i){mt(t,a,i),k(a,n,i),mt(e,a,i),l=!0},p(a,i){const o={};i&2&&(o.data=a[1]),i&4&&(o.currentYear=a[2]),i&8&&(o.selectedCuratorData=a[3]),t.$set(o)},i(a){l||(x(t.$$.fragment,a),x(e.$$.fragment,a),l=!0)},o(a){q(t.$$.fragment,a),q(e.$$.fragment,a),l=!1},d(a){a&&d(n),gt(t,a),gt(e,a)}}}function Xn(r){let t,n,e=r[1].length>0&&r[0].length>0&&$e(r);return{c(){e&&e.c(),t=N()},l(l){e&&e.l(l),t=N()},m(l,a){e&&e.m(l,a),k(l,t,a),n=!0},p(l,[a]){l[1].length>0&&l[0].length>0?e?(e.p(l,a),a&3&&x(e,1)):(e=$e(l),e.c(),x(e,1),e.m(t.parentNode,t)):e&&(Fe(),q(e,1,1,()=>{e=null}),Te())},i(l){n||(x(e),n=!0)},o(l){q(e),n=!1},d(l){l&&d(t),e&&e.d(l)}}}function qn(r,t,n){let e=[],l=[],a=2011,i,o=null;Ot(async()=>{const f=await fetch("data/ArnArbPlantsGEO.json");n(1,e=await f.json()),Math.min(...e.map(h=>parseInt(h.ACC_YR))),i=Math.max(...e.map(h=>parseInt(h.ACC_YR))),n(2,a=i);const g=await fetch("data/Curator_Plants_Dates.json");n(0,l=await g.json()),l.length>0&&n(3,o=l[0])});function s(f){n(3,o=f.detail.selectedCuratorData)}const u={Eudicot:"#d7191c",Ginkgoopsida:"#fdae61",Monocot:"#ffffbf",Lycopodiopsida:"#abdda4",Pinopsida:"#2b83ba"};return r.$$.update=()=>{r.$$.dirty&1&&console.log(l)},[l,e,a,o,s,u]}class jn extends ct{constructor(t){super(),ut(this,t,qn,Xn,st,{})}}export{jn as component};
