import{s as me,n as ge,d as m,i as S,p as X,r as Ze,O as w,h as y,P as D,z as Xt,x as u,Q as Ke,R as le,e as k,f as q,k as $,S as un,l as B,m as K,j as Z,t as Q,y as Je,T as fn,U as xe,V as hn,b as ce}from"../chunks/C2CFgrAZ.js";import{S as ve,i as ke,d as Ne,t as G,a as z,m as Pe,e as Re,b as Ie,c as Ae,g as Fe}from"../chunks/w_dtK-mc.js";import{e as N,u as jt,d as Zt,z as dn,s as et,i as tt,m as nt,a as rt,l as lt}from"../chunks/H-TdytL9.js";class ie{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let l=0;l<this._n&&l<32;l++){const i=t[l],a=e+i,s=Math.abs(e)<Math.abs(i)?e-(a-i):i-(a-e);s&&(t[n++]=s),e=a}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t=this._n,n,l,i,a=0;if(t>0){for(a=e[--t];t>0&&(n=a,l=e[--t],a=n+l,i=l-(a-n),!i););t>0&&(i<0&&e[t-1]<0||i>0&&e[t-1]>0)&&(l=i*2,n=a+l,l==n-a&&(a=n))}return a}}var gn=Math.PI,_n=gn*2,pn=Math.abs,Qe=Math.sqrt;function H(){}function Ee(r,e){r&&at.hasOwnProperty(r.type)&&at[r.type](r,e)}var it={Feature:function(r,e){Ee(r.geometry,e)},FeatureCollection:function(r,e){for(var t=r.features,n=-1,l=t.length;++n<l;)Ee(t[n].geometry,e)}},at={Sphere:function(r,e){e.sphere()},Point:function(r,e){r=r.coordinates,e.point(r[0],r[1],r[2])},MultiPoint:function(r,e){for(var t=r.coordinates,n=-1,l=t.length;++n<l;)r=t[n],e.point(r[0],r[1],r[2])},LineString:function(r,e){Oe(r.coordinates,e,0)},MultiLineString:function(r,e){for(var t=r.coordinates,n=-1,l=t.length;++n<l;)Oe(t[n],e,0)},Polygon:function(r,e){st(r.coordinates,e)},MultiPolygon:function(r,e){for(var t=r.coordinates,n=-1,l=t.length;++n<l;)st(t[n],e)},GeometryCollection:function(r,e){for(var t=r.geometries,n=-1,l=t.length;++n<l;)Ee(t[n],e)}};function Oe(r,e,t){var n=-1,l=r.length-t,i;for(e.lineStart();++n<l;)i=r[n],e.point(i[0],i[1],i[2]);e.lineEnd()}function st(r,e){var t=-1,n=r.length;for(e.polygonStart();++t<n;)Oe(r[t],e,1);e.polygonEnd()}function oe(r,e){r&&it.hasOwnProperty(r.type)?it[r.type](r,e):Ee(r,e)}const mn=r=>r;var ze=new ie,qe=new ie,Qt,$t,Be,Ve,j={point:H,lineStart:H,lineEnd:H,polygonStart:function(){j.lineStart=vn,j.lineEnd=yn},polygonEnd:function(){j.lineStart=j.lineEnd=j.point=H,ze.add(pn(qe)),qe=new ie},result:function(){var r=ze/2;return ze=new ie,r}};function vn(){j.point=kn}function kn(r,e){j.point=Kt,Qt=Be=r,$t=Ve=e}function Kt(r,e){qe.add(Ve*r-Be*e),Be=r,Ve=e}function yn(){Kt(Qt,$t)}var ae=1/0,we=ae,_e=-ae,De=_e,ot={point:bn,lineStart:H,lineEnd:H,polygonStart:H,polygonEnd:H,result:function(){var r=[[ae,we],[_e,De]];return _e=De=-(we=ae=1/0),r}};function bn(r,e){r<ae&&(ae=r),r>_e&&(_e=r),e<we&&(we=e),e>De&&(De=e)}var He=0,Ue=0,ue=0,Se=0,Ce=0,re=0,We=0,Ge=0,fe=0,Jt,xt,U,W,O={point:ee,lineStart:ct,lineEnd:ut,polygonStart:function(){O.lineStart=Dn,O.lineEnd=Sn},polygonEnd:function(){O.point=ee,O.lineStart=ct,O.lineEnd=ut},result:function(){var r=fe?[We/fe,Ge/fe]:re?[Se/re,Ce/re]:ue?[He/ue,Ue/ue]:[NaN,NaN];return He=Ue=ue=Se=Ce=re=We=Ge=fe=0,r}};function ee(r,e){He+=r,Ue+=e,++ue}function ct(){O.point=En}function En(r,e){O.point=wn,ee(U=r,W=e)}function wn(r,e){var t=r-U,n=e-W,l=Qe(t*t+n*n);Se+=l*(U+r)/2,Ce+=l*(W+e)/2,re+=l,ee(U=r,W=e)}function ut(){O.point=ee}function Dn(){O.point=Cn}function Sn(){en(Jt,xt)}function Cn(r,e){O.point=en,ee(Jt=U=r,xt=W=e)}function en(r,e){var t=r-U,n=e-W,l=Qe(t*t+n*n);Se+=l*(U+r)/2,Ce+=l*(W+e)/2,re+=l,l=W*r-U*e,We+=l*(U+r),Ge+=l*(W+e),fe+=l*3,ee(U=r,W=e)}function tn(r){this._context=r}tn.prototype={_radius:4.5,pointRadius:function(r){return this._radius=r,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(r,e){switch(this._point){case 0:{this._context.moveTo(r,e),this._point=1;break}case 1:{this._context.lineTo(r,e);break}default:{this._context.moveTo(r+this._radius,e),this._context.arc(r,e,this._radius,0,_n);break}}},result:H};var Xe=new ie,Te,nn,rn,he,de,pe={point:H,lineStart:function(){pe.point=Mn},lineEnd:function(){Te&&ln(nn,rn),pe.point=H},polygonStart:function(){Te=!0},polygonEnd:function(){Te=null},result:function(){var r=+Xe;return Xe=new ie,r}};function Mn(r,e){pe.point=ln,nn=he=r,rn=de=e}function ln(r,e){he-=r,de-=e,Xe.add(Qe(he*he+de*de)),he=r,de=e}let ft,Me,ht,dt;class gt{constructor(e){this._append=e==null?an:Nn(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:{this._append`M${e},${t}`,this._point=1;break}case 1:{this._append`L${e},${t}`;break}default:{if(this._append`M${e},${t}`,this._radius!==ht||this._append!==Me){const n=this._radius,l=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,ht=n,Me=this._append,dt=this._,this._=l}this._+=dt;break}}}result(){const e=this._;return this._="",e.length?e:null}}function an(r){let e=1;this._+=r[0];for(const t=r.length;e<t;++e)this._+=arguments[e]+r[e]}function Nn(r){const e=Math.floor(r);if(!(e>=0))throw new RangeError(`invalid digits: ${r}`);if(e>15)return an;if(e!==ft){const t=10**e;ft=e,Me=function(l){let i=1;this._+=l[0];for(const a=l.length;i<a;++i)this._+=Math.round(arguments[i]*t)/t+l[i]}}return Me}function Pn(r,e){let t=3,n=4.5,l,i;function a(s){return s&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),oe(s,l(i))),i.result()}return a.area=function(s){return oe(s,l(j)),j.result()},a.measure=function(s){return oe(s,l(pe)),pe.result()},a.bounds=function(s){return oe(s,l(ot)),ot.result()},a.centroid=function(s){return oe(s,l(O)),O.result()},a.projection=function(s){return arguments.length?(l=s==null?(r=null,mn):(r=s).stream,a):r},a.context=function(s){return arguments.length?(i=s==null?(e=null,new gt(t)):new tn(e=s),typeof n!="function"&&i.pointRadius(n),a):e},a.pointRadius=function(s){return arguments.length?(n=typeof s=="function"?s:(i.pointRadius(+s),+s),a):n},a.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const c=Math.floor(s);if(!(c>=0))throw new RangeError(`invalid digits: ${s}`);t=c}return e===null&&(i=new gt(t)),a},a.projection(r).digits(t).context(e)}function Rn(r){return{stream:In(r)}}function In(r){return function(e){var t=new je;for(var n in r)t[n]=r[n];return t.stream=e,t}}function je(){}je.prototype={constructor:je,point:function(r,e){this.stream.point(r,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _t(r,e,t){const n=r.slice();return n[7]=e[t],n[9]=t,n}function pt(r){let e,t=[],n=new Map,l=N(r[0].features);const i=a=>a[7].id||a[9];for(let a=0;a<l.length;a+=1){let s=_t(r,l,a),c=i(s);n.set(c,t[a]=mt(c,s))}return{c(){e=D("g");for(let a=0;a<t.length;a+=1)t[a].c()},l(a){e=w(a,"g",{});var s=y(e);for(let c=0;c<t.length;c+=1)t[c].l(s);s.forEach(m)},m(a,s){S(a,e,s);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);r[6](e)},p(a,s){s&3&&(l=N(a[0].features),t=jt(t,s,i,1,a,l,n,e,Zt,mt,null,_t))},d(a){a&&m(e);for(let s=0;s<t.length;s+=1)t[s].d();r[6](null)}}}function mt(r,e){let t,n,l;return{key:r,first:null,c(){t=D("path"),this.h()},l(i){t=w(i,"path",{d:!0,class:!0}),y(t).forEach(m),this.h()},h(){u(t,"d",n=e[1](e[7])),u(t,"class",l=Ke("pixel "+e[7].properties.type)+" svelte-1bv6vkc"),this.first=t},m(i,a){S(i,t,a)},p(i,a){e=i,a&3&&n!==(n=e[1](e[7]))&&u(t,"d",n),a&1&&l!==(l=Ke("pixel "+e[7].properties.type)+" svelte-1bv6vkc")&&u(t,"class",l)},d(i){i&&m(t)}}}function Yn(r){let e,t=r[0]&&r[1]&&pt(r);return{c(){t&&t.c(),e=X()},l(n){t&&t.l(n),e=X()},m(n,l){t&&t.m(n,l),S(n,e,l)},p(n,[l]){n[0]&&n[1]?t?t.p(n,l):(t=pt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ge,o:ge,d(n){n&&m(e),t&&t.d(n)}}}function zn(r,e,t){let{xScale:n}=e,{yScale:l}=e,{transform:i={x:0,y:0,k:1}}=e,a=null,s=null,c;Ze(async()=>{try{const o=await fetch("pixelated.geojson");t(0,a=await o.json()),console.log("Loaded pixelated geojson:",a.features.length,"features");const d=Rn({point(_,g){this.stream.point(n(_),l(g))}});t(1,s=Pn().projection(d))}catch(o){console.error("Error loading pixelated.geojson",o)}});function f(o){Xt[o?"unshift":"push"](()=>{c=o,t(2,c)})}return r.$$set=o=>{"xScale"in o&&t(3,n=o.xScale),"yScale"in o&&t(4,l=o.yScale),"transform"in o&&t(5,i=o.transform)},[a,s,c,n,l,i,f]}class Tn extends ve{constructor(e){super(),ke(this,e,zn,Yn,me,{xScale:3,yScale:4,transform:5})}}function vt(r,e,t){const n=r.slice();return n[21]=e[t],n[23]=t,n}function kt(r,e,t){const n=r.slice();return n[21]=e[t],n}function yt(r,e,t){const n=r.slice();return n[26]=e[t],n[23]=t,n}function Ln(r){let e,t;return{c(){e=D("circle"),this.h()},l(n){e=w(n,"circle",{r:!0,fill:!0,stroke:!0,class:!0}),y(e).forEach(m),this.h()},h(){u(e,"r",r[6]),u(e,"fill","none"),u(e,"stroke",t=r[8](r[21].plantType)),u(e,"class","node-ring svelte-163ibqd")},m(n,l){S(n,e,l)},p(n,l){l&2&&t!==(t=n[8](n[21].plantType))&&u(e,"stroke",t)},d(n){n&&m(e)}}}function An(r){let e,t=N(Array(r[21].numRings)),n=[];for(let l=0;l<t.length;l+=1)n[l]=bt(yt(r,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=X()},l(l){for(let i=0;i<n.length;i+=1)n[i].l(l);e=X()},m(l,i){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(l,i);S(l,e,i)},p(l,i){if(i&450){t=N(Array(l[21].numRings));let a;for(a=0;a<t.length;a+=1){const s=yt(l,t,a);n[a]?n[a].p(s,i):(n[a]=bt(s),n[a].c(),n[a].m(e.parentNode,e))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(l){l&&m(e),le(n,l)}}}function bt(r){let e,t;return{c(){e=D("circle"),this.h()},l(n){e=w(n,"circle",{r:!0,fill:!0,stroke:!0,class:!0}),y(e).forEach(m),this.h()},h(){u(e,"r",r[6]+r[23]*r[7]),u(e,"fill","none"),u(e,"stroke",t=r[8](r[21].plantType)),u(e,"class","node-ring svelte-163ibqd")},m(n,l){S(n,e,l)},p(n,l){l&2&&t!==(t=n[8](n[21].plantType))&&u(e,"stroke",t)},d(n){n&&m(e)}}}function Et(r){let e,t;function n(a,s){return a[21].numRings>0?An:Ln}let l=n(r),i=l(r);return{c(){e=D("g"),i.c(),this.h()},l(a){e=w(a,"g",{class:!0,transform:!0});var s=y(e);i.l(s),s.forEach(m),this.h()},h(){u(e,"class","node svelte-163ibqd"),u(e,"transform",t="translate("+r[21].x+", "+r[21].y+")")},m(a,s){S(a,e,s),i.m(e,null)},p(a,s){l===(l=n(a))&&i?i.p(a,s):(i.d(1),i=l(a),i&&(i.c(),i.m(e,null))),s&2&&t!==(t="translate("+a[21].x+", "+a[21].y+")")&&u(e,"transform",t)},d(a){a&&m(e),i.d()}}}function wt(r){let e,t,n,l,i=N(r[2].slice(0,r[2].length-1)),a=[];for(let s=0;s<i.length;s+=1)a[s]=St(vt(r,i,s));return{c(){e=D("g"),t=D("defs"),n=D("marker"),l=D("polygon");for(let s=0;s<a.length;s+=1)a[s].c();this.h()},l(s){e=w(s,"g",{class:!0});var c=y(e);t=w(c,"defs",{});var f=y(t);n=w(f,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var o=y(n);l=w(o,"polygon",{points:!0,class:!0}),y(l).forEach(m),o.forEach(m),f.forEach(m);for(let d=0;d<a.length;d+=1)a[d].l(c);c.forEach(m),this.h()},h(){u(l,"points","0 0, 6 2, 0 4"),u(l,"class","arrowhead svelte-163ibqd"),u(n,"id","arrowhead"),u(n,"markerWidth","6"),u(n,"markerHeight","4"),u(n,"refX","3"),u(n,"refY","2"),u(n,"orient","auto"),u(e,"class","curator-path svelte-163ibqd")},m(s,c){S(s,e,c),k(e,t),k(t,n),k(n,l);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null)},p(s,c){if(c&4){i=N(s[2].slice(0,s[2].length-1));let f;for(f=0;f<i.length;f+=1){const o=vt(s,i,f);a[f]?a[f].p(o,c):(a[f]=St(o),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=i.length}},d(s){s&&m(e),le(a,s)}}}function Dt(r){let e,t;return{c(){e=D("path"),this.h()},l(n){e=w(n,"path",{d:!0,fill:!0,class:!0,"marker-end":!0}),y(e).forEach(m),this.h()},h(){u(e,"d",t=Rt(r[21],r[2][r[23]+1])),u(e,"fill","none"),u(e,"class","curator-path-line svelte-163ibqd"),u(e,"marker-end","url(#arrowhead)")},m(n,l){S(n,e,l)},p(n,l){l&4&&t!==(t=Rt(n[21],n[2][n[23]+1]))&&u(e,"d",t)},d(n){n&&m(e)}}}function St(r){let e,t=r[2][r[23]+1]&&Dt(r);return{c(){t&&t.c(),e=X()},l(n){t&&t.l(n),e=X()},m(n,l){t&&t.m(n,l),S(n,e,l)},p(n,l){n[2][n[23]+1]?t?t.p(n,l):(t=Dt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&m(e),t&&t.d(n)}}}function Fn(r){let e,t,n,l,i,a;n=new Tn({props:{transform:r[5],xScale:r[3],yScale:r[4]}});let s=N(r[1]),c=[];for(let o=0;o<s.length;o+=1)c[o]=Et(kt(r,s,o));let f=r[2].length>1&&wt(r);return{c(){e=D("svg"),t=D("g"),Ie(n.$$.fragment);for(let o=0;o<c.length;o+=1)c[o].c();l=X(),f&&f.c(),this.h()},l(o){e=w(o,"svg",{class:!0});var d=y(e);t=w(d,"g",{transform:!0});var _=y(t);Re(n.$$.fragment,_);for(let g=0;g<c.length;g+=1)c[g].l(_);l=X(),f&&f.l(_),_.forEach(m),d.forEach(m),this.h()},h(){u(t,"transform",i="translate("+r[5].x+", "+r[5].y+") scale("+r[5].k+")"),u(e,"class","svelte-163ibqd")},m(o,d){S(o,e,d),k(e,t),Pe(n,t,null);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(t,null);k(t,l),f&&f.m(t,null),r[12](e),a=!0},p(o,[d]){const _={};if(d&32&&(_.transform=o[5]),d&8&&(_.xScale=o[3]),d&16&&(_.yScale=o[4]),n.$set(_),d&450){s=N(o[1]);let g;for(g=0;g<s.length;g+=1){const p=kt(o,s,g);c[g]?c[g].p(p,d):(c[g]=Et(p),c[g].c(),c[g].m(t,l))}for(;g<c.length;g+=1)c[g].d(1);c.length=s.length}o[2].length>1?f?f.p(o,d):(f=wt(o),f.c(),f.m(t,null)):f&&(f.d(1),f=null),(!a||d&32&&i!==(i="translate("+o[5].x+", "+o[5].y+") scale("+o[5].k+")"))&&u(t,"transform",i)},i(o){a||(z(n.$$.fragment,o),a=!0)},o(o){G(n.$$.fragment,o),a=!1},d(o){o&&m(e),Ne(n),le(c,o),f&&f.d(),r[12](null)}}}const Ct=1,Mt=1,Nt=10,Pt=4;function Rt(r,e,t=20){const n=e.x-r.x,l=e.y-r.y,i=(r.x+e.x)/2,a=(r.y+e.y)/2,s=Math.sqrt(n*n+l*l)||1,c=-l/s,f=n/s,o=i+c*t,d=a+f*t;return`M ${r.x} ${r.y} Q ${o} ${d} ${e.x} ${e.y}`}function On(r,e,t){let{data:n=[]}=e,{currentYear:l}=e,{selectedCuratorData:i=null}=e,a,s=[],c=[],f,o,d=tt,_;const g=Ct+(Nt-1)*Mt,p=Pt/2/g,h=Ct*p,v=Mt*p,b=g*p,C=Pt;function te(){const E=a.clientWidth,V=a.clientHeight,M=n.map(A=>parseFloat(A.LONGITUDE)).filter(A=>!isNaN(A)),T=n.map(A=>parseFloat(A.LATITUDE)).filter(A=>!isNaN(A));let P=nt(M),R=rt(M),I=nt(T),Y=rt(T);const L=(R-P)*.2,J=(Y-I)*.2;P-=L,R+=L,I-=J,Y+=J,t(3,f=lt().domain([P,R]).range([0,E])),t(4,o=lt().domain([I,Y]).range([V,0]))}function se(){if(!n||!a||l===void 0)return[];te();const E=new Map;n.forEach((M,T)=>{const P=parseFloat(M.LONGITUDE),R=parseFloat(M.LATITUDE),I=parseInt(M.ACC_YR);if(parseInt(M.last_date),isNaN(P)||isNaN(R)||isNaN(I))return;let Y=0;l>=I&&(Y=Math.floor((l-I)/10),Y=Math.min(Y,Nt));let L=Y>0?h+(Y-1)*v:h;L=Math.min(L,b);const J=f(P),A=o(R),ye=Math.floor(J/C),ne=Math.floor(A/C),x=`${ye}-${ne}`,Ye=ye*C+C/2,F=ne*C+C/2,be={plantType:M.KIND_OF_SPECIMEN_FULL,numRings:Y,outerRadius:L,plantID:M.PLANTID?String(M.PLANTID).toLowerCase():String(T)};if(!E.has(x))E.set(x,{x:Ye,y:F,records:[be],count:1});else{const $e=E.get(x);$e.records.push(be),$e.count++}});const V=[];return E.forEach((M,T)=>{const{x:P,y:R,records:I}=M,Y=I.length,L={};I.forEach(F=>{L[F.plantType]=(L[F.plantType]||0)+1});let J=null,A=0;for(let F in L)L[F]>A&&(A=L[F],J=F);const ye=I.reduce((F,be)=>F+be.numRings,0);let ne=Math.floor(ye/Y),x=ne>0?h+(ne-1)*v:h;x=Math.min(x,b);const Ye=I.map(F=>F.plantID);V.push({id:T,x:P,y:R,numRings:ne,outerRadius:x,plantType:J,count:Y,plantIDs:Ye})}),V}Ze(()=>{_=dn().scaleExtent([2,14]).on("zoom",I=>{t(5,d=I.transform)}),et(a).call(_);const E=a.clientWidth,V=a.clientHeight,M=2,T=E/2-M*(E/1.8),P=V/2-M*(V/2.5),R=tt.translate(T,P).scale(M);et(a).call(_.transform,R),t(5,d=R)});const sn={"herb. - flower":"#C2185B","herb. - fruit":"#FF8A65","herb. - vegetative":"#43A047",seed:"#FBC02D","herb. - twig/buds":"#5E35B1","fruit colln":"#039BE5","herb. - seedling":"#00897B",bark:"#6D4C41"};function on(E){return sn[E]||"rgb(255, 141, 1)"}function cn(E){Xt[E?"unshift":"push"](()=>{a=E,t(0,a)})}return r.$$set=E=>{"data"in E&&t(9,n=E.data),"currentYear"in E&&t(10,l=E.currentYear),"selectedCuratorData"in E&&t(11,i=E.selectedCuratorData)},r.$$.update=()=>{if(r.$$.dirty&1537&&n&&a&&l!==void 0&&t(1,s=se()),r.$$.dirty&2050)if(i&&i.PlantDates){let E=[...i.PlantDates].sort((M,T)=>M.Date-T.Date),V=[];E.forEach(M=>{const T=String(M.PlantID).toLowerCase(),P=s.find(R=>R.plantIDs&&R.plantIDs.includes(T));P&&!V.includes(P)&&V.push(P)}),t(2,c=V)}else t(2,c=[])},[a,s,c,f,o,d,h,v,on,n,l,i,cn]}class qn extends ve{constructor(e){super(),ke(this,e,On,Fn,me,{data:9,currentYear:10,selectedCuratorData:11})}}function It(r,e,t){const n=r.slice();return n[2]=e[t],n}function Yt(r,e,t){const n=r.slice();return n[5]=e[t],n[7]=t,n}function zt(r){let e,t,n=r[7]===0?"1 year":`${r[7]*10} years`,l;return{c(){e=D("circle"),t=D("text"),l=Q(n),this.h()},l(i){e=w(i,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0}),y(e).forEach(m),t=w(i,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0,class:!0});var a=y(t);l=Z(a,n),a.forEach(m),this.h()},h(){u(e,"r",At+r[7]*Le),u(e,"fill","none"),u(e,"stroke","#888"),u(e,"stroke-width","1"),u(t,"x",At+r[7]*Le+20),u(t,"y",r[7]*Le/2+5),u(t,"dy","0.35em"),u(t,"text-anchor","middle"),u(t,"fill","black"),u(t,"font-size","10"),u(t,"class","svelte-1kn6isz")},m(i,a){S(i,e,a),S(i,t,a),k(t,l)},p:ge,d(i){i&&(m(e),m(t))}}}function Tt(r){let e,t,n,l,i=r[2]+"",a,s;return{c(){e=B("div"),t=B("div"),n=K(),l=B("span"),a=Q(i),s=K(),this.h()},l(c){e=q(c,"DIV",{class:!0});var f=y(e);t=q(f,"DIV",{class:!0,style:!0}),y(t).forEach(m),n=$(f),l=q(f,"SPAN",{class:!0});var o=y(l);a=Z(o,i),o.forEach(m),s=$(f),f.forEach(m),this.h()},h(){u(t,"class","color-box svelte-1kn6isz"),Je(t,"background-color",r[0][r[2]]||"rgb(255, 141, 1)"),u(l,"class","label svelte-1kn6isz"),u(e,"class","swatch-row svelte-1kn6isz")},m(c,f){S(c,e,f),k(e,t),k(e,n),k(e,l),k(l,a),k(e,s)},p(c,f){f&1&&Je(t,"background-color",c[0][c[2]]||"rgb(255, 141, 1)")},d(c){c&&m(e)}}}function Bn(r){let e,t,n,l,i,a,s,c='<div class="color-box svelte-1kn6isz" style="background-color: rgb(255, 141, 1);"></div> <span class="label svelte-1kn6isz">Other / Undefined</span>',f=N(Array(Lt+1)),o=[];for(let g=0;g<f.length;g+=1)o[g]=zt(Yt(r,f,g));let d=N(r[1]),_=[];for(let g=0;g<d.length;g+=1)_[g]=Tt(It(r,d,g));return{c(){e=B("div"),t=D("svg"),n=D("g");for(let g=0;g<o.length;g+=1)o[g].c();l=K(),i=B("div");for(let g=0;g<_.length;g+=1)_[g].c();a=K(),s=B("div"),s.innerHTML=c,this.h()},l(g){e=q(g,"DIV",{class:!0});var p=y(e);t=w(p,"svg",{class:!0,preserveAspectRatio:!0,width:!0,height:!0});var h=y(t);n=w(h,"g",{transform:!0});var v=y(n);for(let C=0;C<o.length;C+=1)o[C].l(v);v.forEach(m),h.forEach(m),l=$(p),i=q(p,"DIV",{class:!0});var b=y(i);for(let C=0;C<_.length;C+=1)_[C].l(b);a=$(b),s=q(b,"DIV",{class:!0,"data-svelte-h":!0}),un(s)!=="svelte-19qfir0"&&(s.innerHTML=c),b.forEach(m),p.forEach(m),this.h()},h(){u(n,"transform","translate(0,60)"),u(t,"class","infographic svelte-1kn6isz"),u(t,"preserveAspectRatio","xMidYMid meet"),u(t,"width","100%"),u(t,"height","150"),u(s,"class","swatch-row svelte-1kn6isz"),u(i,"class","color-swatch-section svelte-1kn6isz"),u(e,"class","legend-container svelte-1kn6isz")},m(g,p){S(g,e,p),k(e,t),k(t,n);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(n,null);k(e,l),k(e,i);for(let h=0;h<_.length;h+=1)_[h]&&_[h].m(i,null);k(i,a),k(i,s)},p(g,[p]){if(p&0){f=N(Array(Lt+1));let h;for(h=0;h<f.length;h+=1){const v=Yt(g,f,h);o[h]?o[h].p(v,p):(o[h]=zt(v),o[h].c(),o[h].m(n,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=f.length}if(p&3){d=N(g[1]);let h;for(h=0;h<d.length;h+=1){const v=It(g,d,h);_[h]?_[h].p(v,p):(_[h]=Tt(v),_[h].c(),_[h].m(i,a))}for(;h<_.length;h+=1)_[h].d(1);_.length=d.length}},i:ge,o:ge,d(g){g&&m(e),le(o,g),le(_,g)}}}const Lt=20,At=10,Le=20;function Vn(r,e,t){let{classColorMapping:n}=e;const l=Object.keys(n);return r.$$set=i=>{"classColorMapping"in i&&t(0,n=i.classColorMapping)},[n,l]}class Hn extends ve{constructor(e){super(),ke(this,e,Vn,Bn,me,{classColorMapping:0})}}function Ft(r,e,t){const n=r.slice();return n[11]=e[t],n}function Ot(r,e,t){const n=r.slice();return n[14]=e[t],n}function qt(r){let e,t=r[11].CuratorName+"",n;return{c(){e=B("p"),n=Q(t),this.h()},l(l){e=q(l,"P",{class:!0});var i=y(e);n=Z(i,t),i.forEach(m),this.h()},h(){u(e,"class","curator-name svelte-n1dwcb")},m(l,i){S(l,e,i),k(e,n)},p(l,i){i&4&&t!==(t=l[11].CuratorName+"")&&ce(n,t)},d(l){l&&m(e)}}}function Bt(r){let e,t,n,l,i,a,s,c=r[11].PlantDates.length+"",f,o,d=r[11].PlantDates.length===1?"":"s",_,g=N(r[11].PlantDates),p=[];for(let h=0;h<g.length;h+=1)p[h]=Vt(Ot(r,g,h));return{c(){e=D("svg"),t=D("line");for(let h=0;h<p.length;h+=1)p[h].c();n=D("text"),l=Q(r[0]),i=D("text"),a=Q(r[1]),s=D("text"),f=Q(c),o=Q(" annotation"),_=Q(d),this.h()},l(h){e=w(h,"svg",{class:!0,width:!0,height:!0});var v=y(e);t=w(v,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,class:!0}),y(t).forEach(m);for(let se=0;se<p.length;se+=1)p[se].l(v);n=w(v,"text",{x:!0,y:!0,"font-size":!0,fill:!0,class:!0});var b=y(n);l=Z(b,r[0]),b.forEach(m),i=w(v,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var C=y(i);a=Z(C,r[1]),C.forEach(m),s=w(v,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var te=y(s);f=Z(te,c),o=Z(te," annotation"),_=Z(te,d),te.forEach(m),v.forEach(m),this.h()},h(){u(t,"x1","10"),u(t,"y1","12"),u(t,"x2","310"),u(t,"y2","12"),u(t,"stroke","#ccc"),u(t,"stroke-width","1"),u(t,"class","svelte-n1dwcb"),u(n,"x","10"),u(n,"y","8"),u(n,"font-size","8"),u(n,"fill","#333"),u(n,"class","svelte-n1dwcb"),u(i,"x","310"),u(i,"y","8"),u(i,"font-size","8"),u(i,"fill","#333"),u(i,"text-anchor","end"),u(i,"class","svelte-n1dwcb"),u(s,"x","160"),u(s,"y","23"),u(s,"font-size","8"),u(s,"fill","#333"),u(s,"text-anchor","middle"),u(s,"class","svelte-n1dwcb"),u(e,"class","histogram svelte-n1dwcb"),u(e,"width","320"),u(e,"height","25")},m(h,v){S(h,e,v),k(e,t);for(let b=0;b<p.length;b+=1)p[b]&&p[b].m(e,null);k(e,n),k(n,l),k(e,i),k(i,a),k(e,s),k(s,f),k(s,o),k(s,_)},p(h,v){if(v&36){g=N(h[11].PlantDates);let b;for(b=0;b<g.length;b+=1){const C=Ot(h,g,b);p[b]?p[b].p(C,v):(p[b]=Vt(C),p[b].c(),p[b].m(e,n))}for(;b<p.length;b+=1)p[b].d(1);p.length=g.length}v&1&&ce(l,h[0]),v&2&&ce(a,h[1]),v&4&&c!==(c=h[11].PlantDates.length+"")&&ce(f,c),v&4&&d!==(d=h[11].PlantDates.length===1?"":"s")&&ce(_,d)},d(h){h&&m(e),le(p,h)}}}function Vt(r){let e,t;return{c(){e=D("circle"),this.h()},l(n){e=w(n,"circle",{cx:!0,cy:!0,r:!0,class:!0});var l=y(e);l.forEach(m),this.h()},h(){u(e,"cx",t=r[5](r[14].Date)),u(e,"cy","12"),u(e,"r","2"),u(e,"class","svelte-n1dwcb")},m(n,l){S(n,e,l)},p(n,l){l&4&&t!==(t=n[5](n[14].Date))&&u(e,"cx",t)},d(n){n&&m(e)}}}function Ht(r,e){let t,n,l,i,a,s=e[11].CuratorName===e[3]&&qt(e),c=e[11].PlantDates&&e[11].PlantDates.length>0&&Bt(e);function f(){return e[9](e[11])}return{key:r,first:null,c(){t=B("li"),s&&s.c(),n=K(),c&&c.c(),l=K(),this.h()},l(o){t=q(o,"LI",{class:!0});var d=y(t);s&&s.l(d),n=$(d),c&&c.l(d),l=$(d),d.forEach(m),this.h()},h(){u(t,"class","svelte-n1dwcb"),xe(t,"selected",e[11].CuratorName===e[3]),this.first=t},m(o,d){S(o,t,d),s&&s.m(t,null),k(t,n),c&&c.m(t,null),k(t,l),i||(a=hn(t,"click",f),i=!0)},p(o,d){e=o,e[11].CuratorName===e[3]?s?s.p(e,d):(s=qt(e),s.c(),s.m(t,n)):s&&(s.d(1),s=null),e[11].PlantDates&&e[11].PlantDates.length>0?c?c.p(e,d):(c=Bt(e),c.c(),c.m(t,l)):c&&(c.d(1),c=null),d&12&&xe(t,"selected",e[11].CuratorName===e[3])},d(o){o&&m(t),s&&s.d(),c&&c.d(),i=!1,a()}}}function Un(r){let e,t,n,l,i=[],a=new Map,s;t=new Hn({props:{classColorMapping:r[6]}});let c=N(r[2]);const f=o=>o[11].CuratorName;for(let o=0;o<c.length;o+=1){let d=Ft(r,c,o),_=f(d);a.set(_,i[o]=Ht(_,d))}return{c(){e=B("aside"),Ie(t.$$.fragment),n=K(),l=B("ul");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=q(o,"ASIDE",{class:!0});var d=y(e);Re(t.$$.fragment,d),n=$(d),l=q(d,"UL",{class:!0});var _=y(l);for(let g=0;g<i.length;g+=1)i[g].l(_);_.forEach(m),d.forEach(m),this.h()},h(){u(l,"class","svelte-n1dwcb"),u(e,"class","curator-sidebar svelte-n1dwcb")},m(o,d){S(o,e,d),Pe(t,e,null),k(e,n),k(e,l);for(let _=0;_<i.length;_+=1)i[_]&&i[_].m(l,null);s=!0},p(o,[d]){d&63&&(c=N(o[2]),i=jt(i,d,f,1,o,c,a,l,Zt,Ht,null,Ft))},i(o){s||(z(t.$$.fragment,o),s=!0)},o(o){G(t.$$.fragment,o),s=!1},d(o){o&&m(e),Ne(t);for(let d=0;d<i.length;d+=1)i[d].d()}}}function Wn(r){return r&&r.length>0?Math.min(...r):1/0}function Gn(r,e,t){let n,l,{minYear:i}=e,{maxYear:a}=e,{curatorData:s=[]}=e,{initialCurator:c=""}=e;const f=fn();function o(p){t(3,l=p);const h=s.find(v=>v.CuratorName.toLowerCase()===p.toLowerCase());f("curatorChange",{selectedCuratorData:h})}function d(p){return a===i?160:10+(p-i)/(a-i)*300}const _={"herb. - flower":"#C2185B","herb. - fruit":"#FF8A65","herb. - vegetative":"#43A047",seed:"#FBC02D","herb. - twig/buds":"#5E35B1","fruit colln":"#039BE5","herb. - seedling":"#00897B",bark:"#6D4C41"},g=p=>o(p.CuratorName);return r.$$set=p=>{"minYear"in p&&t(0,i=p.minYear),"maxYear"in p&&t(1,a=p.maxYear),"curatorData"in p&&t(7,s=p.curatorData),"initialCurator"in p&&t(8,c=p.initialCurator)},r.$$.update=()=>{r.$$.dirty&128&&t(2,n=s.map(p=>{var h;return{...p,minDate:Wn((h=p.PlantDates)==null?void 0:h.map(v=>v.Date))}}).sort((p,h)=>p.minDate-h.minDate)),r.$$.dirty&260&&t(3,l=c||(n.length>0?n[0].CuratorName:""))},[i,a,n,l,o,d,_,s,c,g]}class Xn extends ve{constructor(e){super(),ke(this,e,Gn,Un,me,{minYear:0,maxYear:1,curatorData:7,initialCurator:8})}}function Ut(r){let e,t,n,l,i=r[1].length>0&&Wt(r),a=r[3]&&r[4]&&Gt(r);return{c(){e=B("div"),t=B("div"),i&&i.c(),n=K(),a&&a.c(),this.h()},l(s){e=q(s,"DIV",{class:!0});var c=y(e);t=q(c,"DIV",{class:!0});var f=y(t);i&&i.l(f),f.forEach(m),n=$(c),a&&a.l(c),c.forEach(m),this.h()},h(){u(t,"class","main svelte-dgiw5l"),u(e,"class","container svelte-dgiw5l")},m(s,c){S(s,e,c),k(e,t),i&&i.m(t,null),k(e,n),a&&a.m(e,null),l=!0},p(s,c){s[1].length>0?i?(i.p(s,c),c&2&&z(i,1)):(i=Wt(s),i.c(),z(i,1),i.m(t,null)):i&&(Fe(),G(i,1,1,()=>{i=null}),Ae()),s[3]&&s[4]?a?(a.p(s,c),c&24&&z(a,1)):(a=Gt(s),a.c(),z(a,1),a.m(e,null)):a&&(Fe(),G(a,1,1,()=>{a=null}),Ae())},i(s){l||(z(i),z(a),l=!0)},o(s){G(i),G(a),l=!1},d(s){s&&m(e),i&&i.d(),a&&a.d()}}}function Wt(r){let e,t;return e=new qn({props:{data:r[1],currentYear:r[2],selectedCuratorData:r[5]}}),{c(){Ie(e.$$.fragment)},l(n){Re(e.$$.fragment,n)},m(n,l){Pe(e,n,l),t=!0},p(n,l){const i={};l&2&&(i.data=n[1]),l&4&&(i.currentYear=n[2]),l&32&&(i.selectedCuratorData=n[5]),e.$set(i)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){G(e.$$.fragment,n),t=!1},d(n){Ne(e,n)}}}function Gt(r){let e,t;return e=new Xn({props:{curatorData:r[0],minYear:r[3],maxYear:r[4]}}),e.$on("curatorChange",r[6]),{c(){Ie(e.$$.fragment)},l(n){Re(e.$$.fragment,n)},m(n,l){Pe(e,n,l),t=!0},p(n,l){const i={};l&1&&(i.curatorData=n[0]),l&8&&(i.minYear=n[3]),l&16&&(i.maxYear=n[4]),e.$set(i)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){G(e.$$.fragment,n),t=!1},d(n){Ne(e,n)}}}function jn(r){let e,t,n=r[1].length>0&&r[0].length>0&&Ut(r);return{c(){n&&n.c(),e=X()},l(l){n&&n.l(l),e=X()},m(l,i){n&&n.m(l,i),S(l,e,i),t=!0},p(l,[i]){l[1].length>0&&l[0].length>0?n?(n.p(l,i),i&3&&z(n,1)):(n=Ut(l),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(Fe(),G(n,1,1,()=>{n=null}),Ae())},i(l){t||(z(n),t=!0)},o(l){G(n),t=!1},d(l){l&&m(e),n&&n.d(l)}}}function Zn(r,e,t){let n=[],l=[],i=2011,a,s,c=null;Ze(async()=>{const o=await fetch("data/ArnArbPlantsinfo.json");t(1,n=await o.json()),t(3,a=Math.min(...n.map(_=>parseInt(_.ACC_YR)))),t(4,s=Math.max(...n.map(_=>parseInt(_.ACC_YR)))),t(2,i=s);const d=await fetch("data/Curator_Plants_Dates.json");t(0,l=await d.json()),l.length>0&&t(5,c=l[0])});function f(o){t(5,c=o.detail.selectedCuratorData)}return r.$$.update=()=>{r.$$.dirty&1&&console.log(l)},[l,n,i,a,s,c,f]}class Jn extends ve{constructor(e){super(),ke(this,e,Zn,jn,me,{})}}export{Jn as component};
