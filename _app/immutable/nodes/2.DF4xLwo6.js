import{s as st,n as V,d as _,i as E,p as z,r as Ot,O as k,h as m,P as w,z as Ye,x as c,Q as Xt,e as v,R as wt,f as x,l as Z,j as H,t as U,k as dt,m as _t,S as en,b as et,T as Ht,U as nn}from"../chunks/CCjlHDLj.js";import{S as ct,i as ut,d as St,t as W,a as T,m as Et,e as bt,b as Ct,c as qe,g as $e}from"../chunks/BDgAEpGB.js";import{e as M,u as Gt,d as Wt,z as rn,s as Ut,i as xt,m as Zt,a as jt,l as Bt}from"../chunks/FxOopCsW.js";class J{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let l=0;l<this._n&&l<32;l++){const a=e[l],i=t+a,o=Math.abs(t)<Math.abs(a)?t-(i-a):a-(i-t);o&&(e[n++]=o),t=i}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e=this._n,n,l,a,i=0;if(e>0){for(i=t[--e];e>0&&(n=i,l=t[--e],i=n+l,a=l-(i-n),!a););e>0&&(a<0&&t[e-1]<0||a>0&&t[e-1]>0)&&(l=a*2,n=i+l,l==n-i&&(i=n))}return i}}var ln=Math.PI,an=ln*2,on=Math.abs,Vt=Math.sqrt;function A(){}function gt(r,t){r&&Jt.hasOwnProperty(r.type)&&Jt[r.type](r,t)}var Qt={Feature:function(r,t){gt(r.geometry,t)},FeatureCollection:function(r,t){for(var e=r.features,n=-1,l=e.length;++n<l;)gt(e[n].geometry,t)}},Jt={Sphere:function(r,t){t.sphere()},Point:function(r,t){r=r.coordinates,t.point(r[0],r[1],r[2])},MultiPoint:function(r,t){for(var e=r.coordinates,n=-1,l=e.length;++n<l;)r=e[n],t.point(r[0],r[1],r[2])},LineString:function(r,t){Rt(r.coordinates,t,0)},MultiLineString:function(r,t){for(var e=r.coordinates,n=-1,l=e.length;++n<l;)Rt(e[n],t,0)},Polygon:function(r,t){Kt(r.coordinates,t)},MultiPolygon:function(r,t){for(var e=r.coordinates,n=-1,l=e.length;++n<l;)Kt(e[n],t)},GeometryCollection:function(r,t){for(var e=r.geometries,n=-1,l=e.length;++n<l;)gt(e[n],t)}};function Rt(r,t,e){var n=-1,l=r.length-e,a;for(t.lineStart();++n<l;)a=r[n],t.point(a[0],a[1],a[2]);t.lineEnd()}function Kt(r,t){var e=-1,n=r.length;for(t.polygonStart();++e<n;)Rt(r[e],t,1);t.polygonEnd()}function tt(r,t){r&&Qt.hasOwnProperty(r.type)?Qt[r.type](r,t):gt(r,t)}const sn=r=>r;var Dt=new J,zt=new J,Te,Fe,Lt,It,O={point:A,lineStart:A,lineEnd:A,polygonStart:function(){O.lineStart=cn,O.lineEnd=fn},polygonEnd:function(){O.lineStart=O.lineEnd=O.point=A,Dt.add(on(zt)),zt=new J},result:function(){var r=Dt/2;return Dt=new J,r}};function cn(){O.point=un}function un(r,t){O.point=Oe,Te=Lt=r,Fe=It=t}function Oe(r,t){zt.add(It*r-Lt*t),Lt=r,It=t}function fn(){Oe(Te,Fe)}var K=1/0,mt=K,at=-K,pt=at,te={point:hn,lineStart:A,lineEnd:A,polygonStart:A,polygonEnd:A,result:function(){var r=[[K,mt],[at,pt]];return at=pt=-(mt=K=1/0),r}};function hn(r,t){r<K&&(K=r),r>at&&(at=r),t<mt&&(mt=t),t>pt&&(pt=t)}var At=0,Yt=0,nt=0,vt=0,yt=0,Q=0,qt=0,$t=0,rt=0,Ge,We,q,$,R={point:j,lineStart:ee,lineEnd:ne,polygonStart:function(){R.lineStart=gn,R.lineEnd=mn},polygonEnd:function(){R.point=j,R.lineStart=ee,R.lineEnd=ne},result:function(){var r=rt?[qt/rt,$t/rt]:Q?[vt/Q,yt/Q]:nt?[At/nt,Yt/nt]:[NaN,NaN];return At=Yt=nt=vt=yt=Q=qt=$t=rt=0,r}};function j(r,t){At+=r,Yt+=t,++nt}function ee(){R.point=dn}function dn(r,t){R.point=_n,j(q=r,$=t)}function _n(r,t){var e=r-q,n=t-$,l=Vt(e*e+n*n);vt+=l*(q+r)/2,yt+=l*($+t)/2,Q+=l,j(q=r,$=t)}function ne(){R.point=j}function gn(){R.point=pn}function mn(){Ve(Ge,We)}function pn(r,t){R.point=Ve,j(Ge=q=r,We=$=t)}function Ve(r,t){var e=r-q,n=t-$,l=Vt(e*e+n*n);vt+=l*(q+r)/2,yt+=l*($+t)/2,Q+=l,l=$*r-q*t,qt+=l*(q+r),$t+=l*($+t),rt+=l*3,j(q=r,$=t)}function Xe(r){this._context=r}Xe.prototype={_radius:4.5,pointRadius:function(r){return this._radius=r,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(r,t){switch(this._point){case 0:{this._context.moveTo(r,t),this._point=1;break}case 1:{this._context.lineTo(r,t);break}default:{this._context.moveTo(r+this._radius,t),this._context.arc(r,t,this._radius,0,an);break}}},result:A};var Tt=new J,Mt,He,Ue,lt,it,ot={point:A,lineStart:function(){ot.point=vn},lineEnd:function(){Mt&&xe(He,Ue),ot.point=A},polygonStart:function(){Mt=!0},polygonEnd:function(){Mt=null},result:function(){var r=+Tt;return Tt=new J,r}};function vn(r,t){ot.point=xe,He=lt=r,Ue=it=t}function xe(r,t){lt-=r,it-=t,Tt.add(Vt(lt*lt+it*it)),lt=r,it=t}let re,kt,le,ie;class ae{constructor(t){this._append=t==null?Ze:yn(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`,this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{if(this._append`M${t},${e}`,this._radius!==le||this._append!==kt){const n=this._radius,l=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,le=n,kt=this._append,ie=this._,this._=l}this._+=ie;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Ze(r){let t=1;this._+=r[0];for(const e=r.length;t<e;++t)this._+=arguments[t]+r[t]}function yn(r){const t=Math.floor(r);if(!(t>=0))throw new RangeError(`invalid digits: ${r}`);if(t>15)return Ze;if(t!==re){const e=10**t;re=t,kt=function(l){let a=1;this._+=l[0];for(const i=l.length;a<i;++a)this._+=Math.round(arguments[a]*e)/e+l[a]}}return kt}function kn(r,t){let e=3,n=4.5,l,a;function i(o){return o&&(typeof n=="function"&&a.pointRadius(+n.apply(this,arguments)),tt(o,l(a))),a.result()}return i.area=function(o){return tt(o,l(O)),O.result()},i.measure=function(o){return tt(o,l(ot)),ot.result()},i.bounds=function(o){return tt(o,l(te)),te.result()},i.centroid=function(o){return tt(o,l(R)),R.result()},i.projection=function(o){return arguments.length?(l=o==null?(r=null,sn):(r=o).stream,i):r},i.context=function(o){return arguments.length?(a=o==null?(t=null,new ae(e)):new Xe(t=o),typeof n!="function"&&a.pointRadius(n),i):t},i.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(a.pointRadius(+o),+o),i):n},i.digits=function(o){if(!arguments.length)return e;if(o==null)e=null;else{const s=Math.floor(o);if(!(s>=0))throw new RangeError(`invalid digits: ${o}`);e=s}return t===null&&(a=new ae(e)),i},i.projection(r).digits(e).context(t)}function wn(r){return{stream:Sn(r)}}function Sn(r){return function(t){var e=new Ft;for(var n in r)e[n]=r[n];return e.stream=t,e}}function Ft(){}Ft.prototype={constructor:Ft,point:function(r,t){this.stream.point(r,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function oe(r,t,e){const n=r.slice();return n[7]=t[e],n[9]=e,n}function se(r){let t,e=[],n=new Map,l=M(r[0].features);const a=i=>i[7].id||i[9];for(let i=0;i<l.length;i+=1){let o=oe(r,l,i),s=a(o);n.set(s,e[i]=ce(s,o))}return{c(){t=w("g");for(let i=0;i<e.length;i+=1)e[i].c()},l(i){t=k(i,"g",{});var o=m(t);for(let s=0;s<e.length;s+=1)e[s].l(o);o.forEach(_)},m(i,o){E(i,t,o);for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(t,null);r[6](t)},p(i,o){o&3&&(l=M(i[0].features),e=Gt(e,o,a,1,i,l,n,t,Wt,ce,null,oe))},d(i){i&&_(t);for(let o=0;o<e.length;o+=1)e[o].d();r[6](null)}}}function ce(r,t){let e,n,l;return{key:r,first:null,c(){e=w("path"),this.h()},l(a){e=k(a,"path",{d:!0,class:!0}),m(e).forEach(_),this.h()},h(){c(e,"d",n=t[1](t[7])),c(e,"class",l=Xt("pixel "+t[7].properties.type)+" svelte-1bv6vkc"),this.first=e},m(a,i){E(a,e,i)},p(a,i){t=a,i&3&&n!==(n=t[1](t[7]))&&c(e,"d",n),i&1&&l!==(l=Xt("pixel "+t[7].properties.type)+" svelte-1bv6vkc")&&c(e,"class",l)},d(a){a&&_(e)}}}function En(r){let t,e=r[0]&&r[1]&&se(r);return{c(){e&&e.c(),t=z()},l(n){e&&e.l(n),t=z()},m(n,l){e&&e.m(n,l),E(n,t,l)},p(n,[l]){n[0]&&n[1]?e?e.p(n,l):(e=se(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:V,o:V,d(n){n&&_(t),e&&e.d(n)}}}function bn(r,t,e){let{xScale:n}=t,{yScale:l}=t,{transform:a={x:0,y:0,k:1}}=t,i=null,o=null,s;Ot(async()=>{try{const u=await fetch("pixelated.geojson");e(0,i=await u.json()),console.log("Loaded pixelated geojson:",i.features.length,"features");const h=wn({point(d,g){this.stream.point(n(d),l(g))}});e(1,o=kn().projection(h))}catch(u){console.error("Error loading pixelated.geojson",u)}});function f(u){Ye[u?"unshift":"push"](()=>{s=u,e(2,s)})}return r.$$set=u=>{"xScale"in u&&e(3,n=u.xScale),"yScale"in u&&e(4,l=u.yScale),"transform"in u&&e(5,a=u.transform)},[i,o,s,n,l,a,f]}class Cn extends ct{constructor(t){super(),ut(this,t,bn,En,st,{xScale:3,yScale:4,transform:5})}}function ue(r,t,e){const n=r.slice();return n[19]=t[e],n[21]=e,n}function fe(r,t,e){const n=r.slice();return n[19]=t[e],n}function he(r,t,e){const n=r.slice();return n[24]=t[e],n[21]=e,n}function Dn(r){let t;return{c(){t=w("circle"),this.h()},l(e){t=k(e,"circle",{r:!0,fill:!0,class:!0}),m(t).forEach(_),this.h()},h(){c(t,"r",r[6]),c(t,"fill","none"),c(t,"class","node-ring svelte-15llzil")},m(e,n){E(e,t,n)},p:V,d(e){e&&_(t)}}}function Mn(r){let t,e=M(Array(r[19].numRings)),n=[];for(let l=0;l<e.length;l+=1)n[l]=de(he(r,e,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();t=z()},l(l){for(let a=0;a<n.length;a+=1)n[a].l(l);t=z()},m(l,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(l,a);E(l,t,a)},p(l,a){if(a&194){e=M(Array(l[19].numRings));let i;for(i=0;i<e.length;i+=1){const o=he(l,e,i);n[i]?n[i].p(o,a):(n[i]=de(o),n[i].c(),n[i].m(t.parentNode,t))}for(;i<n.length;i+=1)n[i].d(1);n.length=e.length}},d(l){l&&_(t),wt(n,l)}}}function de(r){let t;return{c(){t=w("circle"),this.h()},l(e){t=k(e,"circle",{r:!0,fill:!0,class:!0}),m(t).forEach(_),this.h()},h(){c(t,"r",r[6]+r[21]*r[7]),c(t,"fill","none"),c(t,"class","node-ring svelte-15llzil")},m(e,n){E(e,t,n)},p:V,d(e){e&&_(t)}}}function _e(r,t){let e,n;function l(o,s){return o[19].numRings>0?Mn:Dn}let a=l(t),i=a(t);return{key:r,first:null,c(){e=w("g"),i.c(),this.h()},l(o){e=k(o,"g",{class:!0,transform:!0});var s=m(e);i.l(s),s.forEach(_),this.h()},h(){c(e,"class","node svelte-15llzil"),c(e,"transform",n="translate("+t[19].x+", "+t[19].y+")"),this.first=e},m(o,s){E(o,e,s),i.m(e,null)},p(o,s){t=o,a===(a=l(t))&&i?i.p(t,s):(i.d(1),i=a(t),i&&(i.c(),i.m(e,null))),s&2&&n!==(n="translate("+t[19].x+", "+t[19].y+")")&&c(e,"transform",n)},d(o){o&&_(e),i.d()}}}function ge(r){let t,e,n,l,a=M(r[2].slice(0,r[2].length-1)),i=[];for(let o=0;o<a.length;o+=1)i[o]=pe(ue(r,a,o));return{c(){t=w("g"),e=w("defs"),n=w("marker"),l=w("polygon");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){t=k(o,"g",{class:!0});var s=m(t);e=k(s,"defs",{});var f=m(e);n=k(f,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var u=m(n);l=k(u,"polygon",{points:!0,class:!0}),m(l).forEach(_),u.forEach(_),f.forEach(_);for(let h=0;h<i.length;h+=1)i[h].l(s);s.forEach(_),this.h()},h(){c(l,"points","0 0, 6 2, 0 4"),c(l,"class","arrowhead svelte-15llzil"),c(n,"id","arrowhead"),c(n,"markerWidth","6"),c(n,"markerHeight","4"),c(n,"refX","3"),c(n,"refY","2"),c(n,"orient","auto"),c(t,"class","curator-path svelte-15llzil")},m(o,s){E(o,t,s),v(t,e),v(e,n),v(n,l);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(t,null)},p(o,s){if(s&4){a=M(o[2].slice(0,o[2].length-1));let f;for(f=0;f<a.length;f+=1){const u=ue(o,a,f);i[f]?i[f].p(u,s):(i[f]=pe(u),i[f].c(),i[f].m(t,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=a.length}},d(o){o&&_(t),wt(i,o)}}}function me(r){let t,e;return{c(){t=w("path"),this.h()},l(n){t=k(n,"path",{d:!0,fill:!0,class:!0,"marker-end":!0}),m(t).forEach(_),this.h()},h(){c(t,"d",e=Se(r[19],r[2][r[21]+1])),c(t,"fill","none"),c(t,"class","curator-path-line svelte-15llzil"),c(t,"marker-end","url(#arrowhead)")},m(n,l){E(n,t,l)},p(n,l){l&4&&e!==(e=Se(n[19],n[2][n[21]+1]))&&c(t,"d",e)},d(n){n&&_(t)}}}function pe(r){let t,e=r[2][r[21]+1]&&me(r);return{c(){e&&e.c(),t=z()},l(n){e&&e.l(n),t=z()},m(n,l){e&&e.m(n,l),E(n,t,l)},p(n,l){n[2][n[21]+1]?e?e.p(n,l):(e=me(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){n&&_(t),e&&e.d(n)}}}function Nn(r){let t,e,n,l=[],a=new Map,i,o,s;n=new Cn({props:{transform:r[5],xScale:r[3],yScale:r[4]}});let f=M(r[1]);const u=d=>d[19].id;for(let d=0;d<f.length;d+=1){let g=fe(r,f,d),p=u(g);a.set(p,l[d]=_e(p,g))}let h=r[2].length>1&&ge(r);return{c(){t=w("svg"),e=w("g"),Ct(n.$$.fragment);for(let d=0;d<l.length;d+=1)l[d].c();i=z(),h&&h.c(),this.h()},l(d){t=k(d,"svg",{class:!0});var g=m(t);e=k(g,"g",{transform:!0});var p=m(e);bt(n.$$.fragment,p);for(let Y=0;Y<l.length;Y+=1)l[Y].l(p);i=z(),h&&h.l(p),p.forEach(_),g.forEach(_),this.h()},h(){c(e,"transform",o="translate("+r[5].x+", "+r[5].y+") scale("+r[5].k+")"),c(t,"class","svelte-15llzil")},m(d,g){E(d,t,g),v(t,e),Et(n,e,null);for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(e,null);v(e,i),h&&h.m(e,null),r[11](t),s=!0},p(d,[g]){const p={};g&32&&(p.transform=d[5]),g&8&&(p.xScale=d[3]),g&16&&(p.yScale=d[4]),n.$set(p),g&194&&(f=M(d[1]),l=Gt(l,g,u,1,d,f,a,e,Wt,_e,i,fe)),d[2].length>1?h?h.p(d,g):(h=ge(d),h.c(),h.m(e,null)):h&&(h.d(1),h=null),(!s||g&32&&o!==(o="translate("+d[5].x+", "+d[5].y+") scale("+d[5].k+")"))&&c(e,"transform",o)},i(d){s||(T(n.$$.fragment,d),s=!0)},o(d){W(n.$$.fragment,d),s=!1},d(d){d&&_(t),St(n);for(let g=0;g<l.length;g+=1)l[g].d();h&&h.d(),r[11](null)}}}const ve=1,ye=1,ke=10,we=5;function Se(r,t,e=20){const n=t.x-r.x,l=t.y-r.y,a=(r.x+t.x)/2,i=(r.y+t.y)/2,o=Math.sqrt(n*n+l*l)||1,s=-l/o,f=n/o,u=a+s*e,h=i+f*e;return`M ${r.x} ${r.y} Q ${u} ${h} ${t.x} ${t.y}`}function Pn(r,t,e){let n,{data:l=[]}=t,{currentYear:a}=t,{selectedCuratorData:i=null}=t,o,s=[],f,u,h=xt,d;const g=ve+(ke-1)*ye,p=we/2/g,Y=ve*p,X=ye*p,N=g*p,y=we;function b(){o.clientWidth,o.clientHeight;const S=l.map(I=>parseFloat(I.LONGITUDE)).filter(I=>!isNaN(I)),D=l.map(I=>parseFloat(I.LATITUDE)).filter(I=>!isNaN(I));let C=Zt(S),P=jt(S),G=Zt(D),L=jt(D);const B=(P-C)*.2,F=(L-G)*.2;C-=B,P+=B,G-=F,L+=F,e(3,f=Bt().domain([C,P]).range([0,o.clientWidth])),e(4,u=Bt().domain([G,L]).range([o.clientHeight,0]))}function ft(){return!l||!o||a===void 0?[]:(b(),l.map((D,C)=>{const P=parseFloat(D.LONGITUDE),G=parseFloat(D.LATITUDE),L=parseInt(D.ACC_YR),B=parseInt(D.last_date);if(isNaN(P)||isNaN(G)||isNaN(L))return null;let F=0;a>=L&&(F=Math.floor((a-L)/10),F=Math.min(F,ke));let I=F>0?Y+(F-1)*X:Y;I=Math.min(I,N);const je=f(P),Be=u(G),Qe=Math.floor(je/y),Je=Math.floor(Be/y),Ke=Qe*y+y/2,tn=Je*y+y/2;return{id:D.PLANTID?D.PLANTID:C,x:Ke,y:tn,accYear:L,lastDate:B,numRings:F,outerRadius:I}}).filter(Boolean))}Ot(()=>{d=rn().scaleExtent([2,14]).on("zoom",B=>{e(5,h=B.transform)}),Ut(o).call(d);const S=o.clientWidth,D=o.clientHeight,C=2,P=S/2-C*(S/1.8),G=D/2-C*(D/2.5),L=xt.translate(P,G).scale(C);Ut(o).call(d.transform,L),e(5,h=L)});function ht(S){Ye[S?"unshift":"push"](()=>{o=S,e(0,o)})}return r.$$set=S=>{"data"in S&&e(8,l=S.data),"currentYear"in S&&e(9,a=S.currentYear),"selectedCuratorData"in S&&e(10,i=S.selectedCuratorData)},r.$$.update=()=>{if(r.$$.dirty&769&&l&&o&&a!==void 0&&e(1,s=ft()),r.$$.dirty&1030&&i&&i.PlantDates){const D=[...i.PlantDates].sort((C,P)=>C.Date-P.Date).map(C=>String(C.PlantID).toLowerCase());e(2,n=s.filter(C=>D.includes(String(C.id).toLowerCase()))),n.sort((C,P)=>D.indexOf(String(C.id).toLowerCase())-D.indexOf(String(P.id).toLowerCase()))}},e(2,n=[]),[o,s,n,f,u,h,Y,X,l,a,i,ht]}class Rn extends ct{constructor(t){super(),ut(this,t,Pn,Nn,st,{data:8,currentYear:9,selectedCuratorData:10})}}function Ee(r,t,e){const n=r.slice();return n[2]=t[e],n[4]=e,n}function be(r){let t,e,n=r[4]===0?"1 year":`${r[4]*10} years`,l;return{c(){t=w("circle"),e=w("text"),l=U(n),this.h()},l(a){t=k(a,"circle",{r:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0}),m(t).forEach(_),e=k(a,"text",{x:!0,y:!0,dy:!0,"text-anchor":!0,fill:!0,"font-size":!0,class:!0});var i=m(e);l=H(i,n),i.forEach(_),this.h()},h(){c(t,"r",De+r[4]*Nt),c(t,"fill","none"),c(t,"stroke","#888"),c(t,"stroke-width","1"),c(t,"class","svelte-1dwq1cc"),c(e,"x",De+r[4]*Nt+20),c(e,"y",r[4]*Nt/2+5),c(e,"dy","0.35em"),c(e,"text-anchor","middle"),c(e,"fill","black"),c(e,"font-size","10"),c(e,"class","svelte-1dwq1cc")},m(a,i){E(a,t,i),E(a,e,i),v(e,l)},p:V,d(a){a&&(_(t),_(e))}}}function zn(r){let t,e,n,l=M(Array(Ce+1)),a=[];for(let i=0;i<l.length;i+=1)a[i]=be(Ee(r,l,i));return{c(){t=Z("div"),e=w("svg"),n=w("g");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){t=x(i,"DIV",{class:!0});var o=m(t);e=k(o,"svg",{class:!0,preserveAspectRatio:!0});var s=m(e);n=k(s,"g",{transform:!0});var f=m(n);for(let u=0;u<a.length;u+=1)a[u].l(f);f.forEach(_),s.forEach(_),o.forEach(_),this.h()},h(){c(n,"transform","translate(0,60)"),c(e,"class","infographic"),c(e,"preserveAspectRatio","xMidYMid meet"),c(t,"class","legend-container svelte-1dwq1cc")},m(i,o){E(i,t,o),v(t,e),v(e,n);for(let s=0;s<a.length;s+=1)a[s]&&a[s].m(n,null)},p(i,[o]){if(o&0){l=M(Array(Ce+1));let s;for(s=0;s<l.length;s+=1){const f=Ee(i,l,s);a[s]?a[s].p(f,o):(a[s]=be(f),a[s].c(),a[s].m(n,null))}for(;s<a.length;s+=1)a[s].d(1);a.length=l.length}},i:V,o:V,d(i){i&&_(t),wt(a,i)}}}const Ce=20,De=10,Nt=20;function Ln(r,t,e){let{classColorMapping:n}=t;return r.$$set=l=>{"classColorMapping"in l&&e(0,n=l.classColorMapping)},[n]}class In extends ct{constructor(t){super(),ut(this,t,Ln,zn,st,{classColorMapping:0})}}function Me(r,t,e){const n=r.slice();return n[8]=t[e],n}function Ne(r,t,e){const n=r.slice();return n[12]=t[e],n}function Pt(r){const t=r.slice(),e=$n(t[8]);return t[11]=e,t}function Pe(r){let t,e,n,l=r[11].minDate+"",a,i,o=r[11].maxDate+"",s,f,u=r[11].count+"",h,d,g=r[11].count===1?"":"s",p;function Y(y,b){return y[11].maxDate!==y[11].minDate?Yn:An}let X=Y(r),N=X(r);return{c(){t=w("svg"),e=w("line"),N.c(),n=w("text"),a=U(l),i=w("text"),s=U(o),f=w("text"),h=U(u),d=U(" annotation"),p=U(g),this.h()},l(y){t=k(y,"svg",{class:!0,width:!0,height:!0});var b=m(t);e=k(b,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0,class:!0}),m(e).forEach(_),N.l(b),n=k(b,"text",{x:!0,y:!0,"font-size":!0,fill:!0,class:!0});var ft=m(n);a=H(ft,l),ft.forEach(_),i=k(b,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var ht=m(i);s=H(ht,o),ht.forEach(_),f=k(b,"text",{x:!0,y:!0,"font-size":!0,fill:!0,"text-anchor":!0,class:!0});var S=m(f);h=H(S,u),d=H(S," annotation"),p=H(S,g),S.forEach(_),b.forEach(_),this.h()},h(){c(e,"x1","10"),c(e,"y1","20"),c(e,"x2","280"),c(e,"y2","20"),c(e,"stroke","#ccc"),c(e,"stroke-width","2"),c(e,"class","svelte-1p6mwq3"),c(n,"x","10"),c(n,"y","15"),c(n,"font-size","10"),c(n,"fill","#333"),c(n,"class","svelte-1p6mwq3"),c(i,"x","280"),c(i,"y","15"),c(i,"font-size","10"),c(i,"fill","#333"),c(i,"text-anchor","end"),c(i,"class","svelte-1p6mwq3"),c(f,"x","140"),c(f,"y","35"),c(f,"font-size","10"),c(f,"fill","#333"),c(f,"text-anchor","middle"),c(f,"class","svelte-1p6mwq3"),c(t,"class","histogram svelte-1p6mwq3"),c(t,"width","320"),c(t,"height","40")},m(y,b){E(y,t,b),v(t,e),N.m(t,null),v(t,n),v(n,a),v(t,i),v(i,s),v(t,f),v(f,h),v(f,d),v(f,p)},p(y,b){X===(X=Y(y))&&N?N.p(y,b):(N.d(1),N=X(y),N&&(N.c(),N.m(t,n))),b&1&&l!==(l=y[11].minDate+"")&&et(a,l),b&1&&o!==(o=y[11].maxDate+"")&&et(s,o),b&1&&u!==(u=y[11].count+"")&&et(h,u),b&1&&g!==(g=y[11].count===1?"":"s")&&et(p,g)},d(y){y&&_(t),N.d()}}}function An(r){let t;return{c(){t=w("circle"),this.h()},l(e){t=k(e,"circle",{cx:!0,cy:!0,r:!0,class:!0}),m(t).forEach(_),this.h()},h(){c(t,"cx","100"),c(t,"cy","20"),c(t,"r","4"),c(t,"class","svelte-1p6mwq3")},m(e,n){E(e,t,n)},p:V,d(e){e&&_(t)}}}function Yn(r){let t,e=M(r[11].dates),n=[];for(let l=0;l<e.length;l+=1)n[l]=Re(Ne(r,e,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();t=z()},l(l){for(let a=0;a<n.length;a+=1)n[a].l(l);t=z()},m(l,a){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(l,a);E(l,t,a)},p(l,a){if(a&1){e=M(l[11].dates);let i;for(i=0;i<e.length;i+=1){const o=Ne(l,e,i);n[i]?n[i].p(o,a):(n[i]=Re(o),n[i].c(),n[i].m(t.parentNode,t))}for(;i<n.length;i+=1)n[i].d(1);n.length=e.length}},d(l){l&&_(t),wt(n,l)}}}function Re(r){let t,e;return{c(){t=w("circle"),this.h()},l(n){t=k(n,"circle",{cx:!0,cy:!0,r:!0,class:!0}),m(t).forEach(_),this.h()},h(){c(t,"cx",e=Le(r[12],r[11].minDate,r[11].maxDate)),c(t,"cy","20"),c(t,"r","2"),c(t,"class","svelte-1p6mwq3")},m(n,l){E(n,t,l)},p(n,l){l&1&&e!==(e=Le(n[12],n[11].minDate,n[11].maxDate))&&c(t,"cx",e)},d(n){n&&_(t)}}}function ze(r,t){let e,n,l=t[8].CuratorName+"",a,i,o,s,f,u=t[8].PlantDates&&t[8].PlantDates.length>0&&Pe(Pt(t));function h(){return t[6](t[8])}return{key:r,first:null,c(){e=Z("li"),n=Z("div"),a=U(l),i=_t(),u&&u.c(),o=_t(),this.h()},l(d){e=x(d,"LI",{class:!0});var g=m(e);n=x(g,"DIV",{class:!0});var p=m(n);a=H(p,l),p.forEach(_),i=dt(g),u&&u.l(g),o=dt(g),g.forEach(_),this.h()},h(){c(n,"class","curator-name svelte-1p6mwq3"),c(e,"class","svelte-1p6mwq3"),Ht(e,"selected",t[8].CuratorName===t[1]),this.first=e},m(d,g){E(d,e,g),v(e,n),v(n,a),v(e,i),u&&u.m(e,null),v(e,o),s||(f=nn(e,"click",h),s=!0)},p(d,g){t=d,g&1&&l!==(l=t[8].CuratorName+"")&&et(a,l),t[8].PlantDates&&t[8].PlantDates.length>0?u?u.p(Pt(t),g):(u=Pe(Pt(t)),u.c(),u.m(e,o)):u&&(u.d(1),u=null),g&3&&Ht(e,"selected",t[8].CuratorName===t[1])},d(d){d&&_(e),u&&u.d(),s=!1,f()}}}function qn(r){let t,e,n,l,a=[],i=new Map,o;e=new In({props:{classColorMapping:r[3]}});let s=M(r[0]);const f=u=>u[8].CuratorName;for(let u=0;u<s.length;u+=1){let h=Me(r,s,u),d=f(h);i.set(d,a[u]=ze(d,h))}return{c(){t=Z("aside"),Ct(e.$$.fragment),n=_t(),l=Z("ul");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l(u){t=x(u,"ASIDE",{class:!0});var h=m(t);bt(e.$$.fragment,h),n=dt(h),l=x(h,"UL",{class:!0});var d=m(l);for(let g=0;g<a.length;g+=1)a[g].l(d);d.forEach(_),h.forEach(_),this.h()},h(){c(l,"class","svelte-1p6mwq3"),c(t,"class","curator-sidebar svelte-1p6mwq3")},m(u,h){E(u,t,h),Et(e,t,null),v(t,n),v(t,l);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(l,null);o=!0},p(u,[h]){h&7&&(s=M(u[0]),a=Gt(a,h,f,1,u,s,i,l,Wt,ze,null,Me))},i(u){o||(T(e.$$.fragment,u),o=!0)},o(u){W(e.$$.fragment,u),o=!1},d(u){u&&_(t),St(e);for(let h=0;h<a.length;h+=1)a[h].d()}}}function $n(r){const t=r.PlantDates.map(l=>l.Date),e=Math.min(...t),n=Math.max(...t);return{minDate:e,maxDate:n,count:t.length,dates:t}}function Le(r,t,e){return e===t?100:10+(r-t)/(e-t)*180}function Tn(r,t,e){let n,l,{curatorData:a=[]}=t,{initialCurator:i=""}=t;const o=en();function s(h){e(1,l=h);const d=a.find(g=>g.CuratorName.toLowerCase()===h.toLowerCase());o("curatorChange",{selectedCuratorData:d})}const f={Eudicot:"#d7191c",Ginkgoopsida:"#fdae61",Monocot:"#ffffbf",Lycopodiopsida:"#abdda4",Pinopsida:"#2b83ba"},u=h=>s(h.CuratorName);return r.$$set=h=>{"curatorData"in h&&e(4,a=h.curatorData),"initialCurator"in h&&e(5,i=h.initialCurator)},r.$$.update=()=>{r.$$.dirty&16&&e(0,n=a.slice().sort((h,d)=>h.CuratorName.localeCompare(d.CuratorName))),r.$$.dirty&33&&e(1,l=i||(n.length>0?n[0]:""))},[n,l,s,f,a,i,u]}class Fn extends ct{constructor(t){super(),ut(this,t,Tn,qn,st,{curatorData:4,initialCurator:5})}}function Ie(r){let t,e,n,l,a,i=r[1].length>0&&Ae(r);return l=new Fn({props:{curatorData:r[0]}}),l.$on("curatorChange",r[4]),{c(){t=Z("div"),e=Z("div"),i&&i.c(),n=_t(),Ct(l.$$.fragment),this.h()},l(o){t=x(o,"DIV",{class:!0});var s=m(t);e=x(s,"DIV",{class:!0});var f=m(e);i&&i.l(f),f.forEach(_),n=dt(s),bt(l.$$.fragment,s),s.forEach(_),this.h()},h(){c(e,"class","main svelte-dgiw5l"),c(t,"class","container svelte-dgiw5l")},m(o,s){E(o,t,s),v(t,e),i&&i.m(e,null),v(t,n),Et(l,t,null),a=!0},p(o,s){o[1].length>0?i?(i.p(o,s),s&2&&T(i,1)):(i=Ae(o),i.c(),T(i,1),i.m(e,null)):i&&($e(),W(i,1,1,()=>{i=null}),qe());const f={};s&1&&(f.curatorData=o[0]),l.$set(f)},i(o){a||(T(i),T(l.$$.fragment,o),a=!0)},o(o){W(i),W(l.$$.fragment,o),a=!1},d(o){o&&_(t),i&&i.d(),St(l)}}}function Ae(r){let t,e;return t=new Rn({props:{data:r[1],currentYear:r[2],selectedCuratorData:r[3]}}),{c(){Ct(t.$$.fragment)},l(n){bt(t.$$.fragment,n)},m(n,l){Et(t,n,l),e=!0},p(n,l){const a={};l&2&&(a.data=n[1]),l&4&&(a.currentYear=n[2]),l&8&&(a.selectedCuratorData=n[3]),t.$set(a)},i(n){e||(T(t.$$.fragment,n),e=!0)},o(n){W(t.$$.fragment,n),e=!1},d(n){St(t,n)}}}function On(r){let t,e,n=r[1].length>0&&r[0].length>0&&Ie(r);return{c(){n&&n.c(),t=z()},l(l){n&&n.l(l),t=z()},m(l,a){n&&n.m(l,a),E(l,t,a),e=!0},p(l,[a]){l[1].length>0&&l[0].length>0?n?(n.p(l,a),a&3&&T(n,1)):(n=Ie(l),n.c(),T(n,1),n.m(t.parentNode,t)):n&&($e(),W(n,1,1,()=>{n=null}),qe())},i(l){e||(T(n),e=!0)},o(l){W(n),e=!1},d(l){l&&_(t),n&&n.d(l)}}}function Gn(r,t,e){let n=[],l=[],a=2011,i,o=null;Ot(async()=>{const f=await fetch("data/ArnArbPlantsGEO.json");e(1,n=await f.json()),Math.min(...n.map(h=>parseInt(h.ACC_YR))),i=Math.max(...n.map(h=>parseInt(h.ACC_YR))),e(2,a=i);const u=await fetch("data/Curator_Plants_Dates.json");e(0,l=await u.json()),l.length>0&&e(3,o=l[0])});function s(f){e(3,o=f.detail.selectedCuratorData)}return r.$$.update=()=>{r.$$.dirty&1&&console.log(l)},[l,n,a,o,s]}class Hn extends ct{constructor(t){super(),ut(this,t,Gn,On,st,{})}}export{Hn as component};
